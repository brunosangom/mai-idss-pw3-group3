2025-12-05 19:58:46,387 - __main__ - INFO - Generated 16 experiments for grid search
2025-12-05 19:58:46,387 - __main__ - INFO - ============================================================
2025-12-05 19:58:46,388 - __main__ - INFO - Grid Search Configuration:
2025-12-05 19:58:46,388 - __main__ - INFO -   Models: ['Transformer', 'LSTM']
2025-12-05 19:58:46,388 - __main__ - INFO -   Loss Functions: ['BCE', 'Focal']
2025-12-05 19:58:46,388 - __main__ - INFO -   Minority Class Weights: [3, 5, 10, 16]
2025-12-05 19:58:46,388 - __main__ - INFO -   Total Experiments: 16
2025-12-05 19:58:46,389 - __main__ - INFO - ============================================================
2025-12-05 19:58:46,389 - __main__ - INFO - 
============================================================
2025-12-05 19:58:46,390 - __main__ - INFO - Running experiment 1/16: Transformer_BCE_weight3
2025-12-05 19:58:46,390 - __main__ - INFO -   Model: Transformer
2025-12-05 19:58:46,390 - __main__ - INFO -   Loss: BCE
2025-12-05 19:58:46,390 - __main__ - INFO -   Minority Class Weight: 3
2025-12-05 19:58:46,390 - __main__ - INFO - ============================================================
2025-12-05 19:58:46,400 - __main__ - INFO - Starting experiment: Transformer_BCE_weight3
2025-12-05 19:58:46,429 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 19:58:46,432 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 19:58:46,439 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_195846_14e0fbbe
2025-12-05 19:58:46,439 - trainer - INFO - Initializing datasets...
2025-12-05 19:58:46,440 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 19:58:46,441 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 19:59:04,960 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 19:59:06,788 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 19:59:08,712 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 19:59:10,982 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 20:00:20,557 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 20:00:35,698 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 20:00:47,956 - trainer - INFO - Number of features: 19
2025-12-05 20:00:47,956 - trainer - INFO - Initializing model...
2025-12-05 20:00:48,505 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 20:00:48,505 - trainer - INFO - Using weighted BCE loss with minority_class_weight=3
2025-12-05 20:00:51,209 - trainer - INFO - Training components initialized.
2025-12-05 20:00:51,209 - trainer - INFO - Starting training...
2025-12-05 20:00:51,210 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 20:03:02,856 - trainer - INFO - Epoch 1 - Train Loss: 0.0794, Metrics: {'BinaryPrecision': tensor(0.3394, device='cuda:0'), 'BinaryRecall': tensor(0.2452, device='cuda:0'), 'BinaryF1Score': tensor(0.2847, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(12954, device='cuda:0')}
2025-12-05 20:03:34,349 - trainer - INFO - Epoch 1 - Validation Loss: 0.1137, Metrics: {'BinaryPrecision': tensor(0.3444, device='cuda:0'), 'BinaryRecall': tensor(0.5478, device='cuda:0'), 'BinaryF1Score': tensor(0.4229, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(40001, device='cuda:0')}
2025-12-05 20:03:34,368 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_195846_14e0fbbe.pt
2025-12-05 20:05:21,336 - trainer - INFO - Epoch 2 - Train Loss: 0.1677, Metrics: {'BinaryPrecision': tensor(0.3738, device='cuda:0'), 'BinaryRecall': tensor(0.3516, device='cuda:0'), 'BinaryF1Score': tensor(0.3624, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(16997, device='cuda:0')}
2025-12-05 20:05:53,306 - trainer - INFO - Epoch 2 - Validation Loss: 0.1121, Metrics: {'BinaryPrecision': tensor(0.3287, device='cuda:0'), 'BinaryRecall': tensor(0.5939, device='cuda:0'), 'BinaryF1Score': tensor(0.4232, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(45438, device='cuda:0')}
2025-12-05 20:05:53,315 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_195846_14e0fbbe.pt
2025-12-05 20:07:38,886 - trainer - INFO - Epoch 3 - Train Loss: 0.0311, Metrics: {'BinaryPrecision': tensor(0.3907, device='cuda:0'), 'BinaryRecall': tensor(0.3880, device='cuda:0'), 'BinaryF1Score': tensor(0.3894, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17952, device='cuda:0')}
2025-12-05 20:08:12,377 - trainer - INFO - Epoch 3 - Validation Loss: 0.1095, Metrics: {'BinaryPrecision': tensor(0.3661, device='cuda:0'), 'BinaryRecall': tensor(0.4186, device='cuda:0'), 'BinaryF1Score': tensor(0.3906, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(28751, device='cuda:0')}
2025-12-05 20:08:12,384 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_195846_14e0fbbe.pt
2025-12-05 20:09:52,234 - trainer - INFO - Epoch 4 - Train Loss: 0.0684, Metrics: {'BinaryPrecision': tensor(0.3878, device='cuda:0'), 'BinaryRecall': tensor(0.3834, device='cuda:0'), 'BinaryF1Score': tensor(0.3856, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17713, device='cuda:0')}
2025-12-05 20:10:26,018 - trainer - INFO - Epoch 4 - Validation Loss: 0.1130, Metrics: {'BinaryPrecision': tensor(0.2986, device='cuda:0'), 'BinaryRecall': tensor(0.6848, device='cuda:0'), 'BinaryF1Score': tensor(0.4158, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(57674, device='cuda:0')}
2025-12-05 20:11:59,581 - trainer - INFO - Epoch 5 - Train Loss: 0.1050, Metrics: {'BinaryPrecision': tensor(0.4011, device='cuda:0'), 'BinaryRecall': tensor(0.3944, device='cuda:0'), 'BinaryF1Score': tensor(0.3977, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17750, device='cuda:0')}
2025-12-05 20:12:32,970 - trainer - INFO - Epoch 5 - Validation Loss: 0.1063, Metrics: {'BinaryPrecision': tensor(0.3722, device='cuda:0'), 'BinaryRecall': tensor(0.5209, device='cuda:0'), 'BinaryF1Score': tensor(0.4342, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35199, device='cuda:0')}
2025-12-05 20:12:32,979 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_195846_14e0fbbe.pt
2025-12-05 20:12:32,979 - trainer - INFO - Training finished.
2025-12-05 20:12:32,980 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 20:12:51,508 - trainer - INFO - Optimal threshold: 0.4700 (F1: 0.4276)
2025-12-05 20:12:51,514 - trainer - INFO - Threshold updated to 0.4700
2025-12-05 20:12:51,514 - trainer - INFO - Starting testing...
2025-12-05 20:13:40,984 - trainer - INFO - Test Loss: 0.1379, Metrics: {'BinaryPrecision': tensor(0.3178, device='cuda:0'), 'BinaryRecall': tensor(0.4156, device='cuda:0'), 'BinaryF1Score': tensor(0.3602, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 20:13:44,098 - trainer - INFO - Test results saved to src/backend/results/20251205_195846_14e0fbbe.csv
2025-12-05 20:13:44,105 - trainer - INFO - Testing finished.
2025-12-05 20:14:12,275 - __main__ - INFO - Experiment Transformer_BCE_weight3 completed in 925.88s
2025-12-05 20:14:12,281 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3178, device='cuda:0'), 'BinaryRecall': tensor(0.4156, device='cuda:0'), 'BinaryF1Score': tensor(0.3602, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 20:14:12,309 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 20:14:12,309 - __main__ - INFO - 
============================================================
2025-12-05 20:14:12,309 - __main__ - INFO - Running experiment 2/16: Transformer_BCE_weight5
2025-12-05 20:14:12,310 - __main__ - INFO -   Model: Transformer
2025-12-05 20:14:12,310 - __main__ - INFO -   Loss: BCE
2025-12-05 20:14:12,310 - __main__ - INFO -   Minority Class Weight: 5
2025-12-05 20:14:12,310 - __main__ - INFO - ============================================================
2025-12-05 20:14:12,320 - __main__ - INFO - Starting experiment: Transformer_BCE_weight5
2025-12-05 20:14:12,339 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 20:14:12,342 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 20:14:12,350 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_201412_3853221e
2025-12-05 20:14:12,350 - trainer - INFO - Initializing datasets...
2025-12-05 20:14:12,355 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 20:14:12,355 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 20:14:36,847 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 20:14:39,775 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 20:14:42,749 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 20:14:46,202 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 20:20:52,961 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 20:21:06,123 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 20:21:21,159 - trainer - INFO - Number of features: 19
2025-12-05 20:21:21,160 - trainer - INFO - Initializing model...
2025-12-05 20:21:21,226 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 20:21:21,226 - trainer - INFO - Using weighted BCE loss with minority_class_weight=5
2025-12-05 20:21:21,245 - trainer - INFO - Training components initialized.
2025-12-05 20:21:21,245 - trainer - INFO - Starting training...
2025-12-05 20:21:21,246 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 20:23:18,284 - trainer - INFO - Epoch 1 - Train Loss: 0.1120, Metrics: {'BinaryPrecision': tensor(0.2681, device='cuda:0'), 'BinaryRecall': tensor(0.4056, device='cuda:0'), 'BinaryF1Score': tensor(0.3228, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(27121, device='cuda:0')}
2025-12-05 20:23:51,510 - trainer - INFO - Epoch 1 - Validation Loss: 0.1574, Metrics: {'BinaryPrecision': tensor(0.2869, device='cuda:0'), 'BinaryRecall': tensor(0.6955, device='cuda:0'), 'BinaryF1Score': tensor(0.4062, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(60960, device='cuda:0')}
2025-12-05 20:23:51,543 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_201412_3853221e.pt
2025-12-05 20:25:40,445 - trainer - INFO - Epoch 2 - Train Loss: 0.2291, Metrics: {'BinaryPrecision': tensor(0.2872, device='cuda:0'), 'BinaryRecall': tensor(0.5340, device='cuda:0'), 'BinaryF1Score': tensor(0.3735, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(33589, device='cuda:0')}
2025-12-05 20:26:13,770 - trainer - INFO - Epoch 2 - Validation Loss: 0.1556, Metrics: {'BinaryPrecision': tensor(0.2546, device='cuda:0'), 'BinaryRecall': tensor(0.7789, device='cuda:0'), 'BinaryF1Score': tensor(0.3838, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(76922, device='cuda:0')}
2025-12-05 20:26:13,778 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_201412_3853221e.pt
2025-12-05 20:28:01,897 - trainer - INFO - Epoch 3 - Train Loss: 0.0456, Metrics: {'BinaryPrecision': tensor(0.2995, device='cuda:0'), 'BinaryRecall': tensor(0.5656, device='cuda:0'), 'BinaryF1Score': tensor(0.3916, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(34140, device='cuda:0')}
2025-12-05 20:28:35,641 - trainer - INFO - Epoch 3 - Validation Loss: 0.1493, Metrics: {'BinaryPrecision': tensor(0.2959, device='cuda:0'), 'BinaryRecall': tensor(0.6567, device='cuda:0'), 'BinaryF1Score': tensor(0.4080, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(55802, device='cuda:0')}
2025-12-05 20:28:35,648 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_201412_3853221e.pt
2025-12-05 20:30:18,652 - trainer - INFO - Epoch 4 - Train Loss: 0.0822, Metrics: {'BinaryPrecision': tensor(0.2988, device='cuda:0'), 'BinaryRecall': tensor(0.5761, device='cuda:0'), 'BinaryF1Score': tensor(0.3935, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(34547, device='cuda:0')}
2025-12-05 20:30:52,521 - trainer - INFO - Epoch 4 - Validation Loss: 0.1530, Metrics: {'BinaryPrecision': tensor(0.2672, device='cuda:0'), 'BinaryRecall': tensor(0.7648, device='cuda:0'), 'BinaryF1Score': tensor(0.3960, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(71985, device='cuda:0')}
2025-12-05 20:32:35,380 - trainer - INFO - Epoch 5 - Train Loss: 0.1431, Metrics: {'BinaryPrecision': tensor(0.3046, device='cuda:0'), 'BinaryRecall': tensor(0.6008, device='cuda:0'), 'BinaryF1Score': tensor(0.4042, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35599, device='cuda:0')}
2025-12-05 20:33:08,911 - trainer - INFO - Epoch 5 - Validation Loss: 0.1469, Metrics: {'BinaryPrecision': tensor(0.2873, device='cuda:0'), 'BinaryRecall': tensor(0.7357, device='cuda:0'), 'BinaryF1Score': tensor(0.4133, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(64382, device='cuda:0')}
2025-12-05 20:33:08,919 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_201412_3853221e.pt
2025-12-05 20:33:08,920 - trainer - INFO - Training finished.
2025-12-05 20:33:08,920 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 20:33:29,333 - trainer - INFO - Optimal threshold: 0.6000 (F1: 0.4177)
2025-12-05 20:33:29,342 - trainer - INFO - Threshold updated to 0.6000
2025-12-05 20:33:29,343 - trainer - INFO - Starting testing...
2025-12-05 20:34:19,921 - trainer - INFO - Test Loss: 0.1928, Metrics: {'BinaryPrecision': tensor(0.2976, device='cuda:0'), 'BinaryRecall': tensor(0.4142, device='cuda:0'), 'BinaryF1Score': tensor(0.3464, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 20:34:24,117 - trainer - INFO - Test results saved to src/backend/results/20251205_201412_3853221e.csv
2025-12-05 20:34:24,138 - trainer - INFO - Testing finished.
2025-12-05 20:34:52,786 - __main__ - INFO - Experiment Transformer_BCE_weight5 completed in 1240.47s
2025-12-05 20:34:52,790 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2976, device='cuda:0'), 'BinaryRecall': tensor(0.4142, device='cuda:0'), 'BinaryF1Score': tensor(0.3464, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 20:34:52,866 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 20:34:52,867 - __main__ - INFO - 
============================================================
2025-12-05 20:34:52,867 - __main__ - INFO - Running experiment 3/16: Transformer_BCE_weight10
2025-12-05 20:34:52,867 - __main__ - INFO -   Model: Transformer
2025-12-05 20:34:52,867 - __main__ - INFO -   Loss: BCE
2025-12-05 20:34:52,868 - __main__ - INFO -   Minority Class Weight: 10
2025-12-05 20:34:52,868 - __main__ - INFO - ============================================================
2025-12-05 20:34:52,881 - __main__ - INFO - Starting experiment: Transformer_BCE_weight10
2025-12-05 20:34:52,894 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 20:34:52,895 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 20:34:52,910 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_203452_85c7f2b5
2025-12-05 20:34:52,911 - trainer - INFO - Initializing datasets...
2025-12-05 20:34:52,919 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 20:34:52,920 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 20:36:56,463 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 20:37:20,295 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 20:37:43,236 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 20:37:46,704 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 20:45:22,916 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 20:45:40,000 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 20:45:57,622 - trainer - INFO - Number of features: 19
2025-12-05 20:45:57,622 - trainer - INFO - Initializing model...
2025-12-05 20:45:57,700 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 20:45:57,700 - trainer - INFO - Using weighted BCE loss with minority_class_weight=10
2025-12-05 20:45:57,726 - trainer - INFO - Training components initialized.
2025-12-05 20:45:57,726 - trainer - INFO - Starting training...
2025-12-05 20:45:57,727 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 20:48:00,070 - trainer - INFO - Epoch 1 - Train Loss: 0.2589, Metrics: {'BinaryPrecision': tensor(0.1849, device='cuda:0'), 'BinaryRecall': tensor(0.6617, device='cuda:0'), 'BinaryF1Score': tensor(0.2891, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(64152, device='cuda:0')}
2025-12-05 20:48:33,953 - trainer - INFO - Epoch 1 - Validation Loss: 0.2344, Metrics: {'BinaryPrecision': tensor(0.2033, device='cuda:0'), 'BinaryRecall': tensor(0.8951, device='cuda:0'), 'BinaryF1Score': tensor(0.3313, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(110738, device='cuda:0')}
2025-12-05 20:48:33,974 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_203452_85c7f2b5.pt
2025-12-05 20:50:45,561 - trainer - INFO - Epoch 2 - Train Loss: 0.3822, Metrics: {'BinaryPrecision': tensor(0.2059, device='cuda:0'), 'BinaryRecall': tensor(0.7806, device='cuda:0'), 'BinaryF1Score': tensor(0.3258, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(68502, device='cuda:0')}
2025-12-05 20:51:19,419 - trainer - INFO - Epoch 2 - Validation Loss: 0.2278, Metrics: {'BinaryPrecision': tensor(0.1924, device='cuda:0'), 'BinaryRecall': tensor(0.9238, device='cuda:0'), 'BinaryF1Score': tensor(0.3184, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(120765, device='cuda:0')}
2025-12-05 20:51:19,429 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_203452_85c7f2b5.pt
2025-12-05 20:53:11,970 - trainer - INFO - Epoch 3 - Train Loss: 0.0862, Metrics: {'BinaryPrecision': tensor(0.2142, device='cuda:0'), 'BinaryRecall': tensor(0.8039, device='cuda:0'), 'BinaryF1Score': tensor(0.3383, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(67826, device='cuda:0')}
2025-12-05 20:53:45,720 - trainer - INFO - Epoch 3 - Validation Loss: 0.2194, Metrics: {'BinaryPrecision': tensor(0.2292, device='cuda:0'), 'BinaryRecall': tensor(0.8625, device='cuda:0'), 'BinaryF1Score': tensor(0.3622, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(94637, device='cuda:0')}
2025-12-05 20:53:45,728 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_203452_85c7f2b5.pt
2025-12-05 20:55:37,193 - trainer - INFO - Epoch 4 - Train Loss: 0.1354, Metrics: {'BinaryPrecision': tensor(0.2150, device='cuda:0'), 'BinaryRecall': tensor(0.8059, device='cuda:0'), 'BinaryF1Score': tensor(0.3395, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(67162, device='cuda:0')}
2025-12-05 20:56:11,198 - trainer - INFO - Epoch 4 - Validation Loss: 0.2187, Metrics: {'BinaryPrecision': tensor(0.2154, device='cuda:0'), 'BinaryRecall': tensor(0.8940, device='cuda:0'), 'BinaryF1Score': tensor(0.3472, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(104354, device='cuda:0')}
2025-12-05 20:56:11,209 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_203452_85c7f2b5.pt
2025-12-05 20:58:00,891 - trainer - INFO - Epoch 5 - Train Loss: 0.2116, Metrics: {'BinaryPrecision': tensor(0.2211, device='cuda:0'), 'BinaryRecall': tensor(0.8201, device='cuda:0'), 'BinaryF1Score': tensor(0.3483, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(66942, device='cuda:0')}
2025-12-05 20:58:34,817 - trainer - INFO - Epoch 5 - Validation Loss: 0.2210, Metrics: {'BinaryPrecision': tensor(0.2029, device='cuda:0'), 'BinaryRecall': tensor(0.9261, device='cuda:0'), 'BinaryF1Score': tensor(0.3328, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(114792, device='cuda:0')}
2025-12-05 20:58:34,818 - trainer - INFO - Training finished.
2025-12-05 20:58:34,819 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 20:58:57,863 - trainer - INFO - Optimal threshold: 0.8200 (F1: 0.4120)
2025-12-05 20:58:57,876 - trainer - INFO - Threshold updated to 0.8200
2025-12-05 20:58:57,877 - trainer - INFO - Starting testing...
2025-12-05 20:59:47,732 - trainer - INFO - Test Loss: 0.3040, Metrics: {'BinaryPrecision': tensor(0.3019, device='cuda:0'), 'BinaryRecall': tensor(0.3772, device='cuda:0'), 'BinaryF1Score': tensor(0.3354, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 20:59:52,492 - trainer - INFO - Test results saved to src/backend/results/20251205_203452_85c7f2b5.csv
2025-12-05 20:59:52,516 - trainer - INFO - Testing finished.
2025-12-05 21:00:20,765 - __main__ - INFO - Experiment Transformer_BCE_weight10 completed in 1527.88s
2025-12-05 21:00:20,768 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3019, device='cuda:0'), 'BinaryRecall': tensor(0.3772, device='cuda:0'), 'BinaryF1Score': tensor(0.3354, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 21:00:20,810 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 21:00:20,810 - __main__ - INFO - 
============================================================
2025-12-05 21:00:20,811 - __main__ - INFO - Running experiment 4/16: Transformer_BCE_weight16
2025-12-05 21:00:20,811 - __main__ - INFO -   Model: Transformer
2025-12-05 21:00:20,811 - __main__ - INFO -   Loss: BCE
2025-12-05 21:00:20,811 - __main__ - INFO -   Minority Class Weight: 16
2025-12-05 21:00:20,811 - __main__ - INFO - ============================================================
2025-12-05 21:00:20,821 - __main__ - INFO - Starting experiment: Transformer_BCE_weight16
2025-12-05 21:00:20,833 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 21:00:20,835 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 21:00:20,897 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_210020_7a0c64c9
2025-12-05 21:00:20,897 - trainer - INFO - Initializing datasets...
2025-12-05 21:00:20,906 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 21:00:20,906 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 21:03:17,692 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 21:03:50,127 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 21:04:18,167 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 21:04:21,665 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 21:13:00,035 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 21:13:19,123 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 21:13:40,049 - trainer - INFO - Number of features: 19
2025-12-05 21:13:40,049 - trainer - INFO - Initializing model...
2025-12-05 21:13:40,119 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 21:13:40,119 - trainer - INFO - Using weighted BCE loss with minority_class_weight=16
2025-12-05 21:13:40,137 - trainer - INFO - Training components initialized.
2025-12-05 21:13:40,137 - trainer - INFO - Starting training...
2025-12-05 21:13:40,138 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 21:15:49,048 - trainer - INFO - Epoch 1 - Train Loss: 0.2338, Metrics: {'BinaryPrecision': tensor(0.1473, device='cuda:0'), 'BinaryRecall': tensor(0.7843, device='cuda:0'), 'BinaryF1Score': tensor(0.2480, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(95469, device='cuda:0')}
2025-12-05 21:16:22,269 - trainer - INFO - Epoch 1 - Validation Loss: 0.3017, Metrics: {'BinaryPrecision': tensor(0.1818, device='cuda:0'), 'BinaryRecall': tensor(0.9411, device='cuda:0'), 'BinaryF1Score': tensor(0.3047, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(130197, device='cuda:0')}
2025-12-05 21:16:22,298 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_210020_7a0c64c9.pt
2025-12-05 21:18:15,866 - trainer - INFO - Epoch 2 - Train Loss: 0.3554, Metrics: {'BinaryPrecision': tensor(0.1755, device='cuda:0'), 'BinaryRecall': tensor(0.8698, device='cuda:0'), 'BinaryF1Score': tensor(0.2921, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(89541, device='cuda:0')}
2025-12-05 21:18:49,346 - trainer - INFO - Epoch 2 - Validation Loss: 0.2909, Metrics: {'BinaryPrecision': tensor(0.1779, device='cuda:0'), 'BinaryRecall': tensor(0.9403, device='cuda:0'), 'BinaryF1Score': tensor(0.2991, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(132947, device='cuda:0')}
2025-12-05 21:18:49,355 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_210020_7a0c64c9.pt
2025-12-05 21:20:35,177 - trainer - INFO - Epoch 3 - Train Loss: 0.1277, Metrics: {'BinaryPrecision': tensor(0.1851, device='cuda:0'), 'BinaryRecall': tensor(0.8846, device='cuda:0'), 'BinaryF1Score': tensor(0.3062, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(86374, device='cuda:0')}
2025-12-05 21:21:08,803 - trainer - INFO - Epoch 3 - Validation Loss: 0.2727, Metrics: {'BinaryPrecision': tensor(0.1944, device='cuda:0'), 'BinaryRecall': tensor(0.9459, device='cuda:0'), 'BinaryF1Score': tensor(0.3225, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(122363, device='cuda:0')}
2025-12-05 21:21:08,810 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_210020_7a0c64c9.pt
2025-12-05 21:22:53,718 - trainer - INFO - Epoch 4 - Train Loss: 0.1662, Metrics: {'BinaryPrecision': tensor(0.1855, device='cuda:0'), 'BinaryRecall': tensor(0.8865, device='cuda:0'), 'BinaryF1Score': tensor(0.3068, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(85626, device='cuda:0')}
2025-12-05 21:23:28,022 - trainer - INFO - Epoch 4 - Validation Loss: 0.2744, Metrics: {'BinaryPrecision': tensor(0.2026, device='cuda:0'), 'BinaryRecall': tensor(0.9310, device='cuda:0'), 'BinaryF1Score': tensor(0.3328, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(115569, device='cuda:0')}
2025-12-05 21:25:13,699 - trainer - INFO - Epoch 5 - Train Loss: 0.2438, Metrics: {'BinaryPrecision': tensor(0.1902, device='cuda:0'), 'BinaryRecall': tensor(0.8926, device='cuda:0'), 'BinaryF1Score': tensor(0.3135, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(84721, device='cuda:0')}
2025-12-05 21:25:46,966 - trainer - INFO - Epoch 5 - Validation Loss: 0.2824, Metrics: {'BinaryPrecision': tensor(0.1821, device='cuda:0'), 'BinaryRecall': tensor(0.9636, device='cuda:0'), 'BinaryF1Score': tensor(0.3063, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(133074, device='cuda:0')}
2025-12-05 21:25:46,967 - trainer - INFO - Training finished.
2025-12-05 21:25:46,967 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 21:26:10,234 - trainer - INFO - Optimal threshold: 0.7900 (F1: 0.4185)
2025-12-05 21:26:10,252 - trainer - INFO - Threshold updated to 0.7900
2025-12-05 21:26:10,254 - trainer - INFO - Starting testing...
2025-12-05 21:27:00,357 - trainer - INFO - Test Loss: 0.4029, Metrics: {'BinaryPrecision': tensor(0.2886, device='cuda:0'), 'BinaryRecall': tensor(0.4258, device='cuda:0'), 'BinaryF1Score': tensor(0.3440, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 21:27:05,146 - trainer - INFO - Test results saved to src/backend/results/20251205_210020_7a0c64c9.csv
2025-12-05 21:27:05,308 - trainer - INFO - Testing finished.
2025-12-05 21:27:33,832 - __main__ - INFO - Experiment Transformer_BCE_weight16 completed in 1633.01s
2025-12-05 21:27:33,838 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2886, device='cuda:0'), 'BinaryRecall': tensor(0.4258, device='cuda:0'), 'BinaryF1Score': tensor(0.3440, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 21:27:33,883 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 21:27:33,883 - __main__ - INFO - 
============================================================
2025-12-05 21:27:33,883 - __main__ - INFO - Running experiment 5/16: Transformer_Focal_weight3
2025-12-05 21:27:33,883 - __main__ - INFO -   Model: Transformer
2025-12-05 21:27:33,883 - __main__ - INFO -   Loss: Focal
2025-12-05 21:27:33,883 - __main__ - INFO -   Minority Class Weight: 3
2025-12-05 21:27:33,884 - __main__ - INFO - ============================================================
2025-12-05 21:27:33,894 - __main__ - INFO - Starting experiment: Transformer_Focal_weight3
2025-12-05 21:27:33,902 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 21:27:33,903 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 21:27:33,953 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_212733_1a2a2ca0
2025-12-05 21:27:33,953 - trainer - INFO - Initializing datasets...
2025-12-05 21:27:33,957 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 21:27:33,957 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 21:31:07,852 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 21:31:50,036 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 21:32:26,394 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 21:32:29,810 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 21:43:12,293 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 21:43:33,499 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 21:43:54,604 - trainer - INFO - Number of features: 19
2025-12-05 21:43:54,604 - trainer - INFO - Initializing model...
2025-12-05 21:43:54,700 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 21:43:54,701 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=3
2025-12-05 21:43:54,724 - trainer - INFO - Training components initialized.
2025-12-05 21:43:54,725 - trainer - INFO - Starting training...
2025-12-05 21:43:54,725 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 21:46:08,876 - trainer - INFO - Epoch 1 - Train Loss: 0.0239, Metrics: {'BinaryPrecision': tensor(0.3244, device='cuda:0'), 'BinaryRecall': tensor(0.1808, device='cuda:0'), 'BinaryF1Score': tensor(0.2322, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(9993, device='cuda:0')}
2025-12-05 21:46:43,074 - trainer - INFO - Epoch 1 - Validation Loss: 0.0315, Metrics: {'BinaryPrecision': tensor(0.3453, device='cuda:0'), 'BinaryRecall': tensor(0.3977, device='cuda:0'), 'BinaryF1Score': tensor(0.3697, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(28965, device='cuda:0')}
2025-12-05 21:46:43,092 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_212733_1a2a2ca0.pt
2025-12-05 21:48:43,883 - trainer - INFO - Epoch 2 - Train Loss: 0.0441, Metrics: {'BinaryPrecision': tensor(0.3587, device='cuda:0'), 'BinaryRecall': tensor(0.3328, device='cuda:0'), 'BinaryF1Score': tensor(0.3453, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(16762, device='cuda:0')}
2025-12-05 21:49:19,544 - trainer - INFO - Epoch 2 - Validation Loss: 0.0295, Metrics: {'BinaryPrecision': tensor(0.3383, device='cuda:0'), 'BinaryRecall': tensor(0.5488, device='cuda:0'), 'BinaryF1Score': tensor(0.4185, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(40797, device='cuda:0')}
2025-12-05 21:49:19,553 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_212733_1a2a2ca0.pt
2025-12-05 21:51:14,959 - trainer - INFO - Epoch 3 - Train Loss: 0.0089, Metrics: {'BinaryPrecision': tensor(0.3824, device='cuda:0'), 'BinaryRecall': tensor(0.3797, device='cuda:0'), 'BinaryF1Score': tensor(0.3811, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17945, device='cuda:0')}
2025-12-05 21:51:50,528 - trainer - INFO - Epoch 3 - Validation Loss: 0.0291, Metrics: {'BinaryPrecision': tensor(0.3563, device='cuda:0'), 'BinaryRecall': tensor(0.4045, device='cuda:0'), 'BinaryF1Score': tensor(0.3789, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(28547, device='cuda:0')}
2025-12-05 21:51:50,537 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_212733_1a2a2ca0.pt
2025-12-05 21:53:45,661 - trainer - INFO - Epoch 4 - Train Loss: 0.0182, Metrics: {'BinaryPrecision': tensor(0.3793, device='cuda:0'), 'BinaryRecall': tensor(0.3737, device='cuda:0'), 'BinaryF1Score': tensor(0.3765, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17654, device='cuda:0')}
2025-12-05 21:54:20,129 - trainer - INFO - Epoch 4 - Validation Loss: 0.0297, Metrics: {'BinaryPrecision': tensor(0.2909, device='cuda:0'), 'BinaryRecall': tensor(0.6908, device='cuda:0'), 'BinaryF1Score': tensor(0.4094, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(59707, device='cuda:0')}
2025-12-05 21:56:10,954 - trainer - INFO - Epoch 5 - Train Loss: 0.0287, Metrics: {'BinaryPrecision': tensor(0.3965, device='cuda:0'), 'BinaryRecall': tensor(0.3922, device='cuda:0'), 'BinaryF1Score': tensor(0.3943, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17853, device='cuda:0')}
2025-12-05 21:56:44,883 - trainer - INFO - Epoch 5 - Validation Loss: 0.0286, Metrics: {'BinaryPrecision': tensor(0.3808, device='cuda:0'), 'BinaryRecall': tensor(0.4964, device='cuda:0'), 'BinaryF1Score': tensor(0.4310, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(32780, device='cuda:0')}
2025-12-05 21:56:44,892 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_212733_1a2a2ca0.pt
2025-12-05 21:56:44,892 - trainer - INFO - Training finished.
2025-12-05 21:56:44,892 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 21:57:06,281 - trainer - INFO - Optimal threshold: 0.4800 (F1: 0.4247)
2025-12-05 21:57:06,293 - trainer - INFO - Threshold updated to 0.4800
2025-12-05 21:57:06,293 - trainer - INFO - Starting testing...
2025-12-05 21:57:55,434 - trainer - INFO - Test Loss: 0.0366, Metrics: {'BinaryPrecision': tensor(0.2934, device='cuda:0'), 'BinaryRecall': tensor(0.4618, device='cuda:0'), 'BinaryF1Score': tensor(0.3588, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 21:58:00,565 - trainer - INFO - Test results saved to src/backend/results/20251205_212733_1a2a2ca0.csv
2025-12-05 21:58:00,753 - trainer - INFO - Testing finished.
2025-12-05 21:58:28,075 - __main__ - INFO - Experiment Transformer_Focal_weight3 completed in 1854.18s
2025-12-05 21:58:28,079 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2934, device='cuda:0'), 'BinaryRecall': tensor(0.4618, device='cuda:0'), 'BinaryF1Score': tensor(0.3588, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 21:58:28,140 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 21:58:28,140 - __main__ - INFO - 
============================================================
2025-12-05 21:58:28,140 - __main__ - INFO - Running experiment 6/16: Transformer_Focal_weight5
2025-12-05 21:58:28,140 - __main__ - INFO -   Model: Transformer
2025-12-05 21:58:28,141 - __main__ - INFO -   Loss: Focal
2025-12-05 21:58:28,141 - __main__ - INFO -   Minority Class Weight: 5
2025-12-05 21:58:28,141 - __main__ - INFO - ============================================================
2025-12-05 21:58:28,156 - __main__ - INFO - Starting experiment: Transformer_Focal_weight5
2025-12-05 21:58:28,165 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 21:58:28,166 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 21:58:28,210 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_215828_cca36a6c
2025-12-05 21:58:28,211 - trainer - INFO - Initializing datasets...
2025-12-05 21:58:28,216 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 21:58:28,216 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 22:02:07,790 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 22:02:52,227 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 22:03:27,776 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 22:03:31,313 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 22:14:47,390 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 22:15:09,956 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 22:15:34,547 - trainer - INFO - Number of features: 19
2025-12-05 22:15:34,547 - trainer - INFO - Initializing model...
2025-12-05 22:15:34,626 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 22:15:34,626 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=5
2025-12-05 22:15:34,653 - trainer - INFO - Training components initialized.
2025-12-05 22:15:34,653 - trainer - INFO - Starting training...
2025-12-05 22:15:34,654 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 22:17:36,447 - trainer - INFO - Epoch 1 - Train Loss: 0.0285, Metrics: {'BinaryPrecision': tensor(0.2528, device='cuda:0'), 'BinaryRecall': tensor(0.3656, device='cuda:0'), 'BinaryF1Score': tensor(0.2989, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(25933, device='cuda:0')}
2025-12-05 22:18:11,643 - trainer - INFO - Epoch 1 - Validation Loss: 0.0424, Metrics: {'BinaryPrecision': tensor(0.2730, device='cuda:0'), 'BinaryRecall': tensor(0.7140, device='cuda:0'), 'BinaryF1Score': tensor(0.3950, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(65769, device='cuda:0')}
2025-12-05 22:18:11,667 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_215828_cca36a6c.pt
2025-12-05 22:20:10,173 - trainer - INFO - Epoch 2 - Train Loss: 0.0614, Metrics: {'BinaryPrecision': tensor(0.2787, device='cuda:0'), 'BinaryRecall': tensor(0.5332, device='cuda:0'), 'BinaryF1Score': tensor(0.3661, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(34570, device='cuda:0')}
2025-12-05 22:20:45,624 - trainer - INFO - Epoch 2 - Validation Loss: 0.0401, Metrics: {'BinaryPrecision': tensor(0.2609, device='cuda:0'), 'BinaryRecall': tensor(0.7774, device='cuda:0'), 'BinaryF1Score': tensor(0.3907, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(74923, device='cuda:0')}
2025-12-05 22:20:45,631 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_215828_cca36a6c.pt
2025-12-05 22:22:40,317 - trainer - INFO - Epoch 3 - Train Loss: 0.0142, Metrics: {'BinaryPrecision': tensor(0.2925, device='cuda:0'), 'BinaryRecall': tensor(0.5675, device='cuda:0'), 'BinaryF1Score': tensor(0.3860, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35071, device='cuda:0')}
2025-12-05 22:23:15,136 - trainer - INFO - Epoch 3 - Validation Loss: 0.0390, Metrics: {'BinaryPrecision': tensor(0.3164, device='cuda:0'), 'BinaryRecall': tensor(0.6221, device='cuda:0'), 'BinaryF1Score': tensor(0.4194, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(49450, device='cuda:0')}
2025-12-05 22:23:15,142 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_215828_cca36a6c.pt
2025-12-05 22:25:04,785 - trainer - INFO - Epoch 4 - Train Loss: 0.0239, Metrics: {'BinaryPrecision': tensor(0.2938, device='cuda:0'), 'BinaryRecall': tensor(0.5655, device='cuda:0'), 'BinaryF1Score': tensor(0.3867, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(34494, device='cuda:0')}
2025-12-05 22:25:40,058 - trainer - INFO - Epoch 4 - Validation Loss: 0.0394, Metrics: {'BinaryPrecision': tensor(0.2648, device='cuda:0'), 'BinaryRecall': tensor(0.7763, device='cuda:0'), 'BinaryF1Score': tensor(0.3949, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(73722, device='cuda:0')}
2025-12-05 22:27:31,472 - trainer - INFO - Epoch 5 - Train Loss: 0.0380, Metrics: {'BinaryPrecision': tensor(0.3061, device='cuda:0'), 'BinaryRecall': tensor(0.5753, device='cuda:0'), 'BinaryF1Score': tensor(0.3996, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(33920, device='cuda:0')}
2025-12-05 22:28:08,726 - trainer - INFO - Epoch 5 - Validation Loss: 0.0386, Metrics: {'BinaryPrecision': tensor(0.2828, device='cuda:0'), 'BinaryRecall': tensor(0.7627, device='cuda:0'), 'BinaryF1Score': tensor(0.4126, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(67823, device='cuda:0')}
2025-12-05 22:28:08,740 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_215828_cca36a6c.pt
2025-12-05 22:28:08,740 - trainer - INFO - Training finished.
2025-12-05 22:28:08,740 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 22:28:32,992 - trainer - INFO - Optimal threshold: 0.5400 (F1: 0.4235)
2025-12-05 22:28:33,003 - trainer - INFO - Threshold updated to 0.5400
2025-12-05 22:28:33,004 - trainer - INFO - Starting testing...
2025-12-05 22:29:23,783 - trainer - INFO - Test Loss: 0.0494, Metrics: {'BinaryPrecision': tensor(0.3110, device='cuda:0'), 'BinaryRecall': tensor(0.3913, device='cuda:0'), 'BinaryF1Score': tensor(0.3466, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 22:29:29,510 - trainer - INFO - Test results saved to src/backend/results/20251205_215828_cca36a6c.csv
2025-12-05 22:29:29,694 - trainer - INFO - Testing finished.
2025-12-05 22:29:57,570 - __main__ - INFO - Experiment Transformer_Focal_weight5 completed in 1889.41s
2025-12-05 22:29:57,573 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3110, device='cuda:0'), 'BinaryRecall': tensor(0.3913, device='cuda:0'), 'BinaryF1Score': tensor(0.3466, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 22:29:57,627 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 22:29:57,627 - __main__ - INFO - 
============================================================
2025-12-05 22:29:57,627 - __main__ - INFO - Running experiment 7/16: Transformer_Focal_weight10
2025-12-05 22:29:57,627 - __main__ - INFO -   Model: Transformer
2025-12-05 22:29:57,628 - __main__ - INFO -   Loss: Focal
2025-12-05 22:29:57,628 - __main__ - INFO -   Minority Class Weight: 10
2025-12-05 22:29:57,628 - __main__ - INFO - ============================================================
2025-12-05 22:29:57,642 - __main__ - INFO - Starting experiment: Transformer_Focal_weight10
2025-12-05 22:29:57,652 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 22:29:57,654 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 22:29:57,704 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_222957_2f873311
2025-12-05 22:29:57,704 - trainer - INFO - Initializing datasets...
2025-12-05 22:29:57,710 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 22:29:57,711 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 22:34:16,466 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 22:35:05,511 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 22:35:45,236 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 22:35:48,552 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 22:47:50,389 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 22:48:12,240 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 22:48:37,324 - trainer - INFO - Number of features: 19
2025-12-05 22:48:37,325 - trainer - INFO - Initializing model...
2025-12-05 22:48:37,413 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 22:48:37,414 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=10
2025-12-05 22:48:37,432 - trainer - INFO - Training components initialized.
2025-12-05 22:48:37,432 - trainer - INFO - Starting training...
2025-12-05 22:48:37,432 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 22:50:39,440 - trainer - INFO - Epoch 1 - Train Loss: 0.0430, Metrics: {'BinaryPrecision': tensor(0.1798, device='cuda:0'), 'BinaryRecall': tensor(0.6359, device='cuda:0'), 'BinaryF1Score': tensor(0.2804, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(63398, device='cuda:0')}
2025-12-05 22:51:14,193 - trainer - INFO - Epoch 1 - Validation Loss: 0.0626, Metrics: {'BinaryPrecision': tensor(0.1886, device='cuda:0'), 'BinaryRecall': tensor(0.9187, device='cuda:0'), 'BinaryF1Score': tensor(0.3130, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(122485, device='cuda:0')}
2025-12-05 22:51:14,214 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_222957_2f873311.pt
2025-12-05 22:53:07,671 - trainer - INFO - Epoch 2 - Train Loss: 0.0768, Metrics: {'BinaryPrecision': tensor(0.2034, device='cuda:0'), 'BinaryRecall': tensor(0.7723, device='cuda:0'), 'BinaryF1Score': tensor(0.3220, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(68602, device='cuda:0')}
2025-12-05 22:53:43,128 - trainer - INFO - Epoch 2 - Validation Loss: 0.0610, Metrics: {'BinaryPrecision': tensor(0.1801, device='cuda:0'), 'BinaryRecall': tensor(0.9435, device='cuda:0'), 'BinaryF1Score': tensor(0.3025, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(131730, device='cuda:0')}
2025-12-05 22:53:43,138 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_222957_2f873311.pt
2025-12-05 22:55:32,761 - trainer - INFO - Epoch 3 - Train Loss: 0.0271, Metrics: {'BinaryPrecision': tensor(0.2119, device='cuda:0'), 'BinaryRecall': tensor(0.7965, device='cuda:0'), 'BinaryF1Score': tensor(0.3347, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(67951, device='cuda:0')}
2025-12-05 22:56:07,987 - trainer - INFO - Epoch 3 - Validation Loss: 0.0588, Metrics: {'BinaryPrecision': tensor(0.2272, device='cuda:0'), 'BinaryRecall': tensor(0.8238, device='cuda:0'), 'BinaryF1Score': tensor(0.3562, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(91190, device='cuda:0')}
2025-12-05 22:56:07,994 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_222957_2f873311.pt
2025-12-05 22:57:57,894 - trainer - INFO - Epoch 4 - Train Loss: 0.0338, Metrics: {'BinaryPrecision': tensor(0.2145, device='cuda:0'), 'BinaryRecall': tensor(0.7969, device='cuda:0'), 'BinaryF1Score': tensor(0.3381, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(66551, device='cuda:0')}
2025-12-05 22:58:33,528 - trainer - INFO - Epoch 4 - Validation Loss: 0.0568, Metrics: {'BinaryPrecision': tensor(0.2190, device='cuda:0'), 'BinaryRecall': tensor(0.8840, device='cuda:0'), 'BinaryF1Score': tensor(0.3510, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(101498, device='cuda:0')}
2025-12-05 22:58:33,538 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_222957_2f873311.pt
2025-12-05 23:00:21,316 - trainer - INFO - Epoch 5 - Train Loss: 0.0536, Metrics: {'BinaryPrecision': tensor(0.2207, device='cuda:0'), 'BinaryRecall': tensor(0.8075, device='cuda:0'), 'BinaryF1Score': tensor(0.3466, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(66044, device='cuda:0')}
2025-12-05 23:00:56,072 - trainer - INFO - Epoch 5 - Validation Loss: 0.0563, Metrics: {'BinaryPrecision': tensor(0.2151, device='cuda:0'), 'BinaryRecall': tensor(0.8951, device='cuda:0'), 'BinaryF1Score': tensor(0.3468, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(104655, device='cuda:0')}
2025-12-05 23:00:56,078 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_222957_2f873311.pt
2025-12-05 23:00:56,079 - trainer - INFO - Training finished.
2025-12-05 23:00:56,079 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 23:01:19,152 - trainer - INFO - Optimal threshold: 0.6100 (F1: 0.4148)
2025-12-05 23:01:19,164 - trainer - INFO - Threshold updated to 0.6100
2025-12-05 23:01:19,165 - trainer - INFO - Starting testing...
2025-12-05 23:02:10,489 - trainer - INFO - Test Loss: 0.0763, Metrics: {'BinaryPrecision': tensor(0.3109, device='cuda:0'), 'BinaryRecall': tensor(0.3925, device='cuda:0'), 'BinaryF1Score': tensor(0.3470, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 23:02:15,955 - trainer - INFO - Test results saved to src/backend/results/20251205_222957_2f873311.csv
2025-12-05 23:02:16,165 - trainer - INFO - Testing finished.
2025-12-05 23:02:44,272 - __main__ - INFO - Experiment Transformer_Focal_weight10 completed in 1966.63s
2025-12-05 23:02:44,276 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3109, device='cuda:0'), 'BinaryRecall': tensor(0.3925, device='cuda:0'), 'BinaryF1Score': tensor(0.3470, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 23:02:44,338 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 23:02:44,339 - __main__ - INFO - 
============================================================
2025-12-05 23:02:44,339 - __main__ - INFO - Running experiment 8/16: Transformer_Focal_weight16
2025-12-05 23:02:44,339 - __main__ - INFO -   Model: Transformer
2025-12-05 23:02:44,339 - __main__ - INFO -   Loss: Focal
2025-12-05 23:02:44,339 - __main__ - INFO -   Minority Class Weight: 16
2025-12-05 23:02:44,339 - __main__ - INFO - ============================================================
2025-12-05 23:02:44,353 - __main__ - INFO - Starting experiment: Transformer_Focal_weight16
2025-12-05 23:02:44,362 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 23:02:44,364 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 23:02:44,421 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_230244_8fedb865
2025-12-05 23:02:44,421 - trainer - INFO - Initializing datasets...
2025-12-05 23:02:44,427 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 23:02:44,427 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 23:07:19,051 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 23:08:14,493 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 23:08:58,633 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 23:09:02,117 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 23:22:01,386 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 23:22:23,217 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 23:22:49,307 - trainer - INFO - Number of features: 19
2025-12-05 23:22:49,307 - trainer - INFO - Initializing model...
2025-12-05 23:22:49,394 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-12-05 23:22:49,394 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=16
2025-12-05 23:22:49,418 - trainer - INFO - Training components initialized.
2025-12-05 23:22:49,418 - trainer - INFO - Starting training...
2025-12-05 23:22:49,418 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-05 23:24:56,998 - trainer - INFO - Epoch 1 - Train Loss: 0.0586, Metrics: {'BinaryPrecision': tensor(0.1445, device='cuda:0'), 'BinaryRecall': tensor(0.7735, device='cuda:0'), 'BinaryF1Score': tensor(0.2435, device='cuda:0'), 'TrueWildfiresMetric': tensor(17927, device='cuda:0'), 'PredictedWildfiresMetric': tensor(95985, device='cuda:0')}
2025-12-05 23:25:33,017 - trainer - INFO - Epoch 1 - Validation Loss: 0.0811, Metrics: {'BinaryPrecision': tensor(0.1702, device='cuda:0'), 'BinaryRecall': tensor(0.9504, device='cuda:0'), 'BinaryF1Score': tensor(0.2887, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(140444, device='cuda:0')}
2025-12-05 23:25:33,046 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_230244_8fedb865.pt
2025-12-05 23:27:31,803 - trainer - INFO - Epoch 2 - Train Loss: 0.0931, Metrics: {'BinaryPrecision': tensor(0.1736, device='cuda:0'), 'BinaryRecall': tensor(0.8647, device='cuda:0'), 'BinaryF1Score': tensor(0.2891, device='cuda:0'), 'TrueWildfiresMetric': tensor(18067, device='cuda:0'), 'PredictedWildfiresMetric': tensor(90014, device='cuda:0')}
2025-12-05 23:28:07,177 - trainer - INFO - Epoch 2 - Validation Loss: 0.0778, Metrics: {'BinaryPrecision': tensor(0.1659, device='cuda:0'), 'BinaryRecall': tensor(0.9662, device='cuda:0'), 'BinaryF1Score': tensor(0.2832, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(146467, device='cuda:0')}
2025-12-05 23:28:07,189 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_230244_8fedb865.pt
2025-12-05 23:30:04,612 - trainer - INFO - Epoch 3 - Train Loss: 0.0403, Metrics: {'BinaryPrecision': tensor(0.1827, device='cuda:0'), 'BinaryRecall': tensor(0.8801, device='cuda:0'), 'BinaryF1Score': tensor(0.3026, device='cuda:0'), 'TrueWildfiresMetric': tensor(18076, device='cuda:0'), 'PredictedWildfiresMetric': tensor(87066, device='cuda:0')}
2025-12-05 23:30:39,594 - trainer - INFO - Epoch 3 - Validation Loss: 0.0721, Metrics: {'BinaryPrecision': tensor(0.1830, device='cuda:0'), 'BinaryRecall': tensor(0.9542, device='cuda:0'), 'BinaryF1Score': tensor(0.3070, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(131156, device='cuda:0')}
2025-12-05 23:30:39,605 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_230244_8fedb865.pt
2025-12-05 23:32:33,577 - trainer - INFO - Epoch 4 - Train Loss: 0.0510, Metrics: {'BinaryPrecision': tensor(0.1843, device='cuda:0'), 'BinaryRecall': tensor(0.8847, device='cuda:0'), 'BinaryF1Score': tensor(0.3050, device='cuda:0'), 'TrueWildfiresMetric': tensor(17918, device='cuda:0'), 'PredictedWildfiresMetric': tensor(86027, device='cuda:0')}
2025-12-05 23:33:08,349 - trainer - INFO - Epoch 4 - Validation Loss: 0.0747, Metrics: {'BinaryPrecision': tensor(0.1872, device='cuda:0'), 'BinaryRecall': tensor(0.9300, device='cuda:0'), 'BinaryF1Score': tensor(0.3116, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(124933, device='cuda:0')}
2025-12-05 23:35:05,891 - trainer - INFO - Epoch 5 - Train Loss: 0.0680, Metrics: {'BinaryPrecision': tensor(0.1874, device='cuda:0'), 'BinaryRecall': tensor(0.8911, device='cuda:0'), 'BinaryF1Score': tensor(0.3096, device='cuda:0'), 'TrueWildfiresMetric': tensor(18049, device='cuda:0'), 'PredictedWildfiresMetric': tensor(85840, device='cuda:0')}
2025-12-05 23:35:42,481 - trainer - INFO - Epoch 5 - Validation Loss: 0.0718, Metrics: {'BinaryPrecision': tensor(0.1887, device='cuda:0'), 'BinaryRecall': tensor(0.9490, device='cuda:0'), 'BinaryF1Score': tensor(0.3148, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(126457, device='cuda:0')}
2025-12-05 23:35:42,489 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_230244_8fedb865.pt
2025-12-05 23:35:42,489 - trainer - INFO - Training finished.
2025-12-05 23:35:42,489 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-05 23:36:06,779 - trainer - INFO - Optimal threshold: 0.6700 (F1: 0.4195)
2025-12-05 23:36:06,792 - trainer - INFO - Threshold updated to 0.6700
2025-12-05 23:36:06,793 - trainer - INFO - Starting testing...
2025-12-05 23:37:00,211 - trainer - INFO - Test Loss: 0.1052, Metrics: {'BinaryPrecision': tensor(0.3144, device='cuda:0'), 'BinaryRecall': tensor(0.3914, device='cuda:0'), 'BinaryF1Score': tensor(0.3487, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 23:37:06,247 - trainer - INFO - Test results saved to src/backend/results/20251205_230244_8fedb865.csv
2025-12-05 23:37:06,473 - trainer - INFO - Testing finished.
2025-12-05 23:37:35,085 - __main__ - INFO - Experiment Transformer_Focal_weight16 completed in 2090.73s
2025-12-05 23:37:35,089 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3144, device='cuda:0'), 'BinaryRecall': tensor(0.3914, device='cuda:0'), 'BinaryF1Score': tensor(0.3487, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-05 23:37:35,159 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-05 23:37:35,160 - __main__ - INFO - 
============================================================
2025-12-05 23:37:35,160 - __main__ - INFO - Running experiment 9/16: LSTM_BCE_weight3
2025-12-05 23:37:35,161 - __main__ - INFO -   Model: LSTM
2025-12-05 23:37:35,161 - __main__ - INFO -   Loss: BCE
2025-12-05 23:37:35,161 - __main__ - INFO -   Minority Class Weight: 3
2025-12-05 23:37:35,161 - __main__ - INFO - ============================================================
2025-12-05 23:37:35,178 - __main__ - INFO - Starting experiment: LSTM_BCE_weight3
2025-12-05 23:37:35,191 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-05 23:37:35,195 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-05 23:37:35,253 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251205_233735_b8c8c0be
2025-12-05 23:37:35,254 - trainer - INFO - Initializing datasets...
2025-12-05 23:37:35,260 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-05 23:37:35,260 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-05 23:42:28,897 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-05 23:43:27,192 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-05 23:44:14,568 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-05 23:44:17,820 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-05 23:58:18,323 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-05 23:58:44,025 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-05 23:59:11,908 - trainer - INFO - Number of features: 19
2025-12-05 23:59:11,908 - trainer - INFO - Initializing model...
2025-12-05 23:59:12,064 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-05 23:59:12,064 - trainer - INFO - Using weighted BCE loss with minority_class_weight=3
2025-12-05 23:59:12,086 - trainer - INFO - Training components initialized.
2025-12-05 23:59:12,086 - trainer - INFO - Starting training...
2025-12-05 23:59:12,086 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 00:00:53,517 - trainer - INFO - Epoch 1 - Train Loss: 0.1936, Metrics: {'BinaryPrecision': tensor(0.3637, device='cuda:0'), 'BinaryRecall': tensor(0.2537, device='cuda:0'), 'BinaryF1Score': tensor(0.2989, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(12406, device='cuda:0')}
2025-12-06 00:01:22,164 - trainer - INFO - Epoch 1 - Validation Loss: 0.1194, Metrics: {'BinaryPrecision': tensor(0.3526, device='cuda:0'), 'BinaryRecall': tensor(0.4703, device='cuda:0'), 'BinaryF1Score': tensor(0.4030, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(33540, device='cuda:0')}
2025-12-06 00:01:22,238 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_233735_b8c8c0be.pt
2025-12-06 00:02:48,055 - trainer - INFO - Epoch 2 - Train Loss: 0.0400, Metrics: {'BinaryPrecision': tensor(0.3977, device='cuda:0'), 'BinaryRecall': tensor(0.3789, device='cuda:0'), 'BinaryF1Score': tensor(0.3880, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17006, device='cuda:0')}
2025-12-06 00:03:17,359 - trainer - INFO - Epoch 2 - Validation Loss: 0.1178, Metrics: {'BinaryPrecision': tensor(0.3739, device='cuda:0'), 'BinaryRecall': tensor(0.4486, device='cuda:0'), 'BinaryF1Score': tensor(0.4079, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(30169, device='cuda:0')}
2025-12-06 00:03:17,411 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_233735_b8c8c0be.pt
2025-12-06 00:04:33,248 - trainer - INFO - Epoch 3 - Train Loss: 0.0399, Metrics: {'BinaryPrecision': tensor(0.4039, device='cuda:0'), 'BinaryRecall': tensor(0.4039, device='cuda:0'), 'BinaryF1Score': tensor(0.4039, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17792, device='cuda:0')}
2025-12-06 00:05:01,961 - trainer - INFO - Epoch 3 - Validation Loss: 0.1120, Metrics: {'BinaryPrecision': tensor(0.3651, device='cuda:0'), 'BinaryRecall': tensor(0.5089, device='cuda:0'), 'BinaryF1Score': tensor(0.4251, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35058, device='cuda:0')}
2025-12-06 00:05:01,990 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_233735_b8c8c0be.pt
2025-12-06 00:06:16,338 - trainer - INFO - Epoch 4 - Train Loss: 0.0546, Metrics: {'BinaryPrecision': tensor(0.4090, device='cuda:0'), 'BinaryRecall': tensor(0.4505, device='cuda:0'), 'BinaryF1Score': tensor(0.4288, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(19695, device='cuda:0')}
2025-12-06 00:06:45,315 - trainer - INFO - Epoch 4 - Validation Loss: 0.1125, Metrics: {'BinaryPrecision': tensor(0.4315, device='cuda:0'), 'BinaryRecall': tensor(0.3126, device='cuda:0'), 'BinaryF1Score': tensor(0.3626, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(18218, device='cuda:0')}
2025-12-06 00:08:01,809 - trainer - INFO - Epoch 5 - Train Loss: 0.2058, Metrics: {'BinaryPrecision': tensor(0.4087, device='cuda:0'), 'BinaryRecall': tensor(0.4628, device='cuda:0'), 'BinaryF1Score': tensor(0.4341, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(20262, device='cuda:0')}
2025-12-06 00:08:30,866 - trainer - INFO - Epoch 5 - Validation Loss: 0.1102, Metrics: {'BinaryPrecision': tensor(0.3842, device='cuda:0'), 'BinaryRecall': tensor(0.4895, device='cuda:0'), 'BinaryF1Score': tensor(0.4305, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(32044, device='cuda:0')}
2025-12-06 00:08:30,888 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251205_233735_b8c8c0be.pt
2025-12-06 00:08:30,889 - trainer - INFO - Training finished.
2025-12-06 00:08:30,889 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 00:08:50,390 - trainer - INFO - Optimal threshold: 0.4700 (F1: 0.4305)
2025-12-06 00:08:50,395 - trainer - INFO - Threshold updated to 0.4700
2025-12-06 00:08:50,396 - trainer - INFO - Starting testing...
2025-12-06 00:09:34,382 - trainer - INFO - Test Loss: 0.1469, Metrics: {'BinaryPrecision': tensor(0.3039, device='cuda:0'), 'BinaryRecall': tensor(0.3456, device='cuda:0'), 'BinaryF1Score': tensor(0.3234, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 00:09:40,314 - trainer - INFO - Test results saved to src/backend/results/20251205_233735_b8c8c0be.csv
2025-12-06 00:09:40,334 - trainer - INFO - Testing finished.
2025-12-06 00:10:02,448 - __main__ - INFO - Experiment LSTM_BCE_weight3 completed in 1947.27s
2025-12-06 00:10:02,452 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3039, device='cuda:0'), 'BinaryRecall': tensor(0.3456, device='cuda:0'), 'BinaryF1Score': tensor(0.3234, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 00:10:02,525 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 00:10:02,525 - __main__ - INFO - 
============================================================
2025-12-06 00:10:02,525 - __main__ - INFO - Running experiment 10/16: LSTM_BCE_weight5
2025-12-06 00:10:02,526 - __main__ - INFO -   Model: LSTM
2025-12-06 00:10:02,526 - __main__ - INFO -   Loss: BCE
2025-12-06 00:10:02,526 - __main__ - INFO -   Minority Class Weight: 5
2025-12-06 00:10:02,526 - __main__ - INFO - ============================================================
2025-12-06 00:10:02,541 - __main__ - INFO - Starting experiment: LSTM_BCE_weight5
2025-12-06 00:10:02,550 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 00:10:02,552 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 00:10:02,576 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_001002_053a9d0b
2025-12-06 00:10:02,577 - trainer - INFO - Initializing datasets...
2025-12-06 00:10:02,580 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 00:10:02,580 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 00:15:05,601 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 00:16:04,136 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 00:16:52,708 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 00:16:56,331 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 00:32:02,109 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 00:32:26,450 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 00:32:53,311 - trainer - INFO - Number of features: 19
2025-12-06 00:32:53,312 - trainer - INFO - Initializing model...
2025-12-06 00:32:53,412 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 00:32:53,413 - trainer - INFO - Using weighted BCE loss with minority_class_weight=5
2025-12-06 00:32:53,435 - trainer - INFO - Training components initialized.
2025-12-06 00:32:53,435 - trainer - INFO - Starting training...
2025-12-06 00:32:53,435 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 00:34:27,956 - trainer - INFO - Epoch 1 - Train Loss: 0.2531, Metrics: {'BinaryPrecision': tensor(0.2836, device='cuda:0'), 'BinaryRecall': tensor(0.4392, device='cuda:0'), 'BinaryF1Score': tensor(0.3447, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(27541, device='cuda:0')}
2025-12-06 00:34:56,888 - trainer - INFO - Epoch 1 - Validation Loss: 0.1609, Metrics: {'BinaryPrecision': tensor(0.2827, device='cuda:0'), 'BinaryRecall': tensor(0.6741, device='cuda:0'), 'BinaryF1Score': tensor(0.3983, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(59971, device='cuda:0')}
2025-12-06 00:34:56,973 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_001002_053a9d0b.pt
2025-12-06 00:36:24,659 - trainer - INFO - Epoch 2 - Train Loss: 0.0690, Metrics: {'BinaryPrecision': tensor(0.3063, device='cuda:0'), 'BinaryRecall': tensor(0.5746, device='cuda:0'), 'BinaryF1Score': tensor(0.3996, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(33491, device='cuda:0')}
2025-12-06 00:36:53,499 - trainer - INFO - Epoch 2 - Validation Loss: 0.1602, Metrics: {'BinaryPrecision': tensor(0.2842, device='cuda:0'), 'BinaryRecall': tensor(0.6789, device='cuda:0'), 'BinaryF1Score': tensor(0.4007, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(60079, device='cuda:0')}
2025-12-06 00:36:53,527 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_001002_053a9d0b.pt
2025-12-06 00:38:07,911 - trainer - INFO - Epoch 3 - Train Loss: 0.0558, Metrics: {'BinaryPrecision': tensor(0.3085, device='cuda:0'), 'BinaryRecall': tensor(0.6108, device='cuda:0'), 'BinaryF1Score': tensor(0.4099, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35234, device='cuda:0')}
2025-12-06 00:38:37,157 - trainer - INFO - Epoch 3 - Validation Loss: 0.1503, Metrics: {'BinaryPrecision': tensor(0.2888, device='cuda:0'), 'BinaryRecall': tensor(0.7216, device='cuda:0'), 'BinaryF1Score': tensor(0.4125, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(62839, device='cuda:0')}
2025-12-06 00:38:37,194 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_001002_053a9d0b.pt
2025-12-06 00:39:50,204 - trainer - INFO - Epoch 4 - Train Loss: 0.0767, Metrics: {'BinaryPrecision': tensor(0.3208, device='cuda:0'), 'BinaryRecall': tensor(0.6396, device='cuda:0'), 'BinaryF1Score': tensor(0.4273, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35647, device='cuda:0')}
2025-12-06 00:40:18,192 - trainer - INFO - Epoch 4 - Validation Loss: 0.1525, Metrics: {'BinaryPrecision': tensor(0.3213, device='cuda:0'), 'BinaryRecall': tensor(0.6225, device='cuda:0'), 'BinaryF1Score': tensor(0.4238, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(48722, device='cuda:0')}
2025-12-06 00:41:30,787 - trainer - INFO - Epoch 5 - Train Loss: 0.2461, Metrics: {'BinaryPrecision': tensor(0.3210, device='cuda:0'), 'BinaryRecall': tensor(0.6607, device='cuda:0'), 'BinaryF1Score': tensor(0.4321, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(36834, device='cuda:0')}
2025-12-06 00:41:59,296 - trainer - INFO - Epoch 5 - Validation Loss: 0.1500, Metrics: {'BinaryPrecision': tensor(0.2949, device='cuda:0'), 'BinaryRecall': tensor(0.6903, device='cuda:0'), 'BinaryF1Score': tensor(0.4132, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(58869, device='cuda:0')}
2025-12-06 00:41:59,321 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_001002_053a9d0b.pt
2025-12-06 00:41:59,322 - trainer - INFO - Training finished.
2025-12-06 00:41:59,322 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 00:42:19,630 - trainer - INFO - Optimal threshold: 0.5600 (F1: 0.4116)
2025-12-06 00:42:19,643 - trainer - INFO - Threshold updated to 0.5600
2025-12-06 00:42:19,643 - trainer - INFO - Starting testing...
2025-12-06 00:43:01,849 - trainer - INFO - Test Loss: 0.1960, Metrics: {'BinaryPrecision': tensor(0.2814, device='cuda:0'), 'BinaryRecall': tensor(0.4933, device='cuda:0'), 'BinaryF1Score': tensor(0.3583, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 00:43:08,102 - trainer - INFO - Test results saved to src/backend/results/20251206_001002_053a9d0b.csv
2025-12-06 00:43:08,312 - trainer - INFO - Testing finished.
2025-12-06 00:43:30,686 - __main__ - INFO - Experiment LSTM_BCE_weight5 completed in 2008.14s
2025-12-06 00:43:30,690 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2814, device='cuda:0'), 'BinaryRecall': tensor(0.4933, device='cuda:0'), 'BinaryF1Score': tensor(0.3583, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 00:43:30,766 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 00:43:30,767 - __main__ - INFO - 
============================================================
2025-12-06 00:43:30,767 - __main__ - INFO - Running experiment 11/16: LSTM_BCE_weight10
2025-12-06 00:43:30,767 - __main__ - INFO -   Model: LSTM
2025-12-06 00:43:30,767 - __main__ - INFO -   Loss: BCE
2025-12-06 00:43:30,768 - __main__ - INFO -   Minority Class Weight: 10
2025-12-06 00:43:30,768 - __main__ - INFO - ============================================================
2025-12-06 00:43:30,784 - __main__ - INFO - Starting experiment: LSTM_BCE_weight10
2025-12-06 00:43:30,795 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 00:43:30,797 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 00:43:30,854 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_004330_efe65a15
2025-12-06 00:43:30,854 - trainer - INFO - Initializing datasets...
2025-12-06 00:43:30,861 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 00:43:30,862 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 00:48:56,317 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 00:50:01,393 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 00:50:53,590 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 00:50:56,883 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 01:08:51,582 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 01:09:19,097 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 01:09:48,299 - trainer - INFO - Number of features: 19
2025-12-06 01:09:48,299 - trainer - INFO - Initializing model...
2025-12-06 01:09:48,389 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 01:09:48,390 - trainer - INFO - Using weighted BCE loss with minority_class_weight=10
2025-12-06 01:09:48,414 - trainer - INFO - Training components initialized.
2025-12-06 01:09:48,414 - trainer - INFO - Starting training...
2025-12-06 01:09:48,415 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 01:11:17,118 - trainer - INFO - Epoch 1 - Train Loss: 0.2979, Metrics: {'BinaryPrecision': tensor(0.2064, device='cuda:0'), 'BinaryRecall': tensor(0.6740, device='cuda:0'), 'BinaryF1Score': tensor(0.3161, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(58065, device='cuda:0')}
2025-12-06 01:11:46,890 - trainer - INFO - Epoch 1 - Validation Loss: 0.2376, Metrics: {'BinaryPrecision': tensor(0.2287, device='cuda:0'), 'BinaryRecall': tensor(0.8248, device='cuda:0'), 'BinaryF1Score': tensor(0.3581, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(90703, device='cuda:0')}
2025-12-06 01:11:46,938 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_004330_efe65a15.pt
2025-12-06 01:13:05,528 - trainer - INFO - Epoch 2 - Train Loss: 0.1129, Metrics: {'BinaryPrecision': tensor(0.2252, device='cuda:0'), 'BinaryRecall': tensor(0.7911, device='cuda:0'), 'BinaryF1Score': tensor(0.3506, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(62718, device='cuda:0')}
2025-12-06 01:13:34,485 - trainer - INFO - Epoch 2 - Validation Loss: 0.2398, Metrics: {'BinaryPrecision': tensor(0.2290, device='cuda:0'), 'BinaryRecall': tensor(0.8411, device='cuda:0'), 'BinaryF1Score': tensor(0.3600, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(92356, device='cuda:0')}
2025-12-06 01:14:48,448 - trainer - INFO - Epoch 3 - Train Loss: 0.1068, Metrics: {'BinaryPrecision': tensor(0.2330, device='cuda:0'), 'BinaryRecall': tensor(0.8219, device='cuda:0'), 'BinaryF1Score': tensor(0.3631, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(62751, device='cuda:0')}
2025-12-06 01:15:17,086 - trainer - INFO - Epoch 3 - Validation Loss: 0.2203, Metrics: {'BinaryPrecision': tensor(0.2212, device='cuda:0'), 'BinaryRecall': tensor(0.9042, device='cuda:0'), 'BinaryF1Score': tensor(0.3554, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(102792, device='cuda:0')}
2025-12-06 01:15:17,116 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_004330_efe65a15.pt
2025-12-06 01:16:31,077 - trainer - INFO - Epoch 4 - Train Loss: 0.1358, Metrics: {'BinaryPrecision': tensor(0.2463, device='cuda:0'), 'BinaryRecall': tensor(0.8294, device='cuda:0'), 'BinaryF1Score': tensor(0.3799, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(60209, device='cuda:0')}
2025-12-06 01:16:59,508 - trainer - INFO - Epoch 4 - Validation Loss: 0.2235, Metrics: {'BinaryPrecision': tensor(0.2519, device='cuda:0'), 'BinaryRecall': tensor(0.8134, device='cuda:0'), 'BinaryF1Score': tensor(0.3847, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(81196, device='cuda:0')}
2025-12-06 01:18:12,163 - trainer - INFO - Epoch 5 - Train Loss: 0.3532, Metrics: {'BinaryPrecision': tensor(0.2533, device='cuda:0'), 'BinaryRecall': tensor(0.8388, device='cuda:0'), 'BinaryF1Score': tensor(0.3891, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(59262, device='cuda:0')}
2025-12-06 01:18:40,979 - trainer - INFO - Epoch 5 - Validation Loss: 0.2152, Metrics: {'BinaryPrecision': tensor(0.2542, device='cuda:0'), 'BinaryRecall': tensor(0.8462, device='cuda:0'), 'BinaryF1Score': tensor(0.3910, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(83706, device='cuda:0')}
2025-12-06 01:18:41,006 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_004330_efe65a15.pt
2025-12-06 01:18:41,007 - trainer - INFO - Training finished.
2025-12-06 01:18:41,007 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 01:19:01,432 - trainer - INFO - Optimal threshold: 0.7100 (F1: 0.4288)
2025-12-06 01:19:01,443 - trainer - INFO - Threshold updated to 0.7100
2025-12-06 01:19:01,444 - trainer - INFO - Starting testing...
2025-12-06 01:19:44,766 - trainer - INFO - Test Loss: 0.3014, Metrics: {'BinaryPrecision': tensor(0.3035, device='cuda:0'), 'BinaryRecall': tensor(0.4767, device='cuda:0'), 'BinaryF1Score': tensor(0.3708, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 01:19:51,024 - trainer - INFO - Test results saved to src/backend/results/20251206_004330_efe65a15.csv
2025-12-06 01:19:51,231 - trainer - INFO - Testing finished.
2025-12-06 01:20:13,304 - __main__ - INFO - Experiment LSTM_BCE_weight10 completed in 2202.52s
2025-12-06 01:20:13,309 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3035, device='cuda:0'), 'BinaryRecall': tensor(0.4767, device='cuda:0'), 'BinaryF1Score': tensor(0.3708, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 01:20:13,395 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 01:20:13,395 - __main__ - INFO - 
============================================================
2025-12-06 01:20:13,396 - __main__ - INFO - Running experiment 12/16: LSTM_BCE_weight16
2025-12-06 01:20:13,396 - __main__ - INFO -   Model: LSTM
2025-12-06 01:20:13,396 - __main__ - INFO -   Loss: BCE
2025-12-06 01:20:13,397 - __main__ - INFO -   Minority Class Weight: 16
2025-12-06 01:20:13,397 - __main__ - INFO - ============================================================
2025-12-06 01:20:13,414 - __main__ - INFO - Starting experiment: LSTM_BCE_weight16
2025-12-06 01:20:13,428 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 01:20:13,430 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 01:20:13,482 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_012013_bb5d932c
2025-12-06 01:20:13,482 - trainer - INFO - Initializing datasets...
2025-12-06 01:20:13,490 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 01:20:13,490 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 01:26:00,452 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 01:27:03,193 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 01:27:53,447 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 01:27:57,137 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 01:47:15,734 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 01:47:51,791 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 01:48:23,161 - trainer - INFO - Number of features: 19
2025-12-06 01:48:23,162 - trainer - INFO - Initializing model...
2025-12-06 01:48:23,243 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 01:48:23,243 - trainer - INFO - Using weighted BCE loss with minority_class_weight=16
2025-12-06 01:48:23,268 - trainer - INFO - Training components initialized.
2025-12-06 01:48:23,268 - trainer - INFO - Starting training...
2025-12-06 01:48:23,268 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 01:50:02,755 - trainer - INFO - Epoch 1 - Train Loss: 0.3487, Metrics: {'BinaryPrecision': tensor(0.1640, device='cuda:0'), 'BinaryRecall': tensor(0.7969, device='cuda:0'), 'BinaryF1Score': tensor(0.2720, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(86430, device='cuda:0')}
2025-12-06 01:50:31,056 - trainer - INFO - Epoch 1 - Validation Loss: 0.3044, Metrics: {'BinaryPrecision': tensor(0.2030, device='cuda:0'), 'BinaryRecall': tensor(0.8780, device='cuda:0'), 'BinaryF1Score': tensor(0.3298, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(108754, device='cuda:0')}
2025-12-06 01:50:31,117 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_012013_bb5d932c.pt
2025-12-06 01:51:54,275 - trainer - INFO - Epoch 2 - Train Loss: 0.1408, Metrics: {'BinaryPrecision': tensor(0.1884, device='cuda:0'), 'BinaryRecall': tensor(0.8800, device='cuda:0'), 'BinaryF1Score': tensor(0.3103, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(83398, device='cuda:0')}
2025-12-06 01:52:23,695 - trainer - INFO - Epoch 2 - Validation Loss: 0.2982, Metrics: {'BinaryPrecision': tensor(0.2061, device='cuda:0'), 'BinaryRecall': tensor(0.9110, device='cuda:0'), 'BinaryF1Score': tensor(0.3362, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(111132, device='cuda:0')}
2025-12-06 01:52:23,736 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_012013_bb5d932c.pt
2025-12-06 01:53:38,606 - trainer - INFO - Epoch 3 - Train Loss: 0.1250, Metrics: {'BinaryPrecision': tensor(0.2009, device='cuda:0'), 'BinaryRecall': tensor(0.8943, device='cuda:0'), 'BinaryF1Score': tensor(0.3280, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(79225, device='cuda:0')}
2025-12-06 01:54:08,324 - trainer - INFO - Epoch 3 - Validation Loss: 0.2782, Metrics: {'BinaryPrecision': tensor(0.2055, device='cuda:0'), 'BinaryRecall': tensor(0.9341, device='cuda:0'), 'BinaryF1Score': tensor(0.3368, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(114333, device='cuda:0')}
2025-12-06 01:54:08,355 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_012013_bb5d932c.pt
2025-12-06 01:55:17,768 - trainer - INFO - Epoch 4 - Train Loss: 0.1339, Metrics: {'BinaryPrecision': tensor(0.2093, device='cuda:0'), 'BinaryRecall': tensor(0.9014, device='cuda:0'), 'BinaryF1Score': tensor(0.3397, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(77021, device='cuda:0')}
2025-12-06 01:55:46,472 - trainer - INFO - Epoch 4 - Validation Loss: 0.2781, Metrics: {'BinaryPrecision': tensor(0.2064, device='cuda:0'), 'BinaryRecall': tensor(0.9192, device='cuda:0'), 'BinaryF1Score': tensor(0.3371, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(111990, device='cuda:0')}
2025-12-06 01:55:46,489 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_012013_bb5d932c.pt
2025-12-06 01:56:54,595 - trainer - INFO - Epoch 5 - Train Loss: 0.6004, Metrics: {'BinaryPrecision': tensor(0.2169, device='cuda:0'), 'BinaryRecall': tensor(0.9047, device='cuda:0'), 'BinaryF1Score': tensor(0.3499, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(74647, device='cuda:0')}
2025-12-06 01:57:23,329 - trainer - INFO - Epoch 5 - Validation Loss: 0.2724, Metrics: {'BinaryPrecision': tensor(0.2157, device='cuda:0'), 'BinaryRecall': tensor(0.9277, device='cuda:0'), 'BinaryF1Score': tensor(0.3500, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(108172, device='cuda:0')}
2025-12-06 01:57:23,350 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_012013_bb5d932c.pt
2025-12-06 01:57:23,350 - trainer - INFO - Training finished.
2025-12-06 01:57:23,351 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 01:57:51,167 - trainer - INFO - Optimal threshold: 0.7800 (F1: 0.4270)
2025-12-06 01:57:51,178 - trainer - INFO - Threshold updated to 0.7800
2025-12-06 01:57:51,179 - trainer - INFO - Starting testing...
2025-12-06 01:58:34,417 - trainer - INFO - Test Loss: 0.3896, Metrics: {'BinaryPrecision': tensor(0.2812, device='cuda:0'), 'BinaryRecall': tensor(0.5184, device='cuda:0'), 'BinaryF1Score': tensor(0.3646, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 01:58:40,622 - trainer - INFO - Test results saved to src/backend/results/20251206_012013_bb5d932c.csv
2025-12-06 01:58:40,798 - trainer - INFO - Testing finished.
2025-12-06 01:59:02,648 - __main__ - INFO - Experiment LSTM_BCE_weight16 completed in 2329.23s
2025-12-06 01:59:02,651 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2812, device='cuda:0'), 'BinaryRecall': tensor(0.5184, device='cuda:0'), 'BinaryF1Score': tensor(0.3646, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 01:59:02,727 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 01:59:02,728 - __main__ - INFO - 
============================================================
2025-12-06 01:59:02,728 - __main__ - INFO - Running experiment 13/16: LSTM_Focal_weight3
2025-12-06 01:59:02,729 - __main__ - INFO -   Model: LSTM
2025-12-06 01:59:02,729 - __main__ - INFO -   Loss: Focal
2025-12-06 01:59:02,729 - __main__ - INFO -   Minority Class Weight: 3
2025-12-06 01:59:02,729 - __main__ - INFO - ============================================================
2025-12-06 01:59:02,746 - __main__ - INFO - Starting experiment: LSTM_Focal_weight3
2025-12-06 01:59:02,756 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 01:59:02,758 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 01:59:02,815 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_015902_d58156f5
2025-12-06 01:59:02,816 - trainer - INFO - Initializing datasets...
2025-12-06 01:59:02,822 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 01:59:02,822 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 02:04:36,865 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 02:05:39,441 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 02:06:33,208 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 02:06:36,901 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 02:28:07,685 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 02:28:44,216 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 02:29:26,417 - trainer - INFO - Number of features: 19
2025-12-06 02:29:26,417 - trainer - INFO - Initializing model...
2025-12-06 02:29:26,504 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 02:29:26,504 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=3
2025-12-06 02:29:26,526 - trainer - INFO - Training components initialized.
2025-12-06 02:29:26,526 - trainer - INFO - Starting training...
2025-12-06 02:29:26,526 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 02:30:59,407 - trainer - INFO - Epoch 1 - Train Loss: 0.0435, Metrics: {'BinaryPrecision': tensor(0.3644, device='cuda:0'), 'BinaryRecall': tensor(0.2712, device='cuda:0'), 'BinaryF1Score': tensor(0.3109, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(13237, device='cuda:0')}
2025-12-06 02:31:29,929 - trainer - INFO - Epoch 1 - Validation Loss: 0.0306, Metrics: {'BinaryPrecision': tensor(0.3666, device='cuda:0'), 'BinaryRecall': tensor(0.4530, device='cuda:0'), 'BinaryF1Score': tensor(0.4053, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31075, device='cuda:0')}
2025-12-06 02:31:30,109 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_015902_d58156f5.pt
2025-12-06 02:32:55,714 - trainer - INFO - Epoch 2 - Train Loss: 0.0137, Metrics: {'BinaryPrecision': tensor(0.3946, device='cuda:0'), 'BinaryRecall': tensor(0.3891, device='cuda:0'), 'BinaryF1Score': tensor(0.3918, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(17601, device='cuda:0')}
2025-12-06 02:33:25,657 - trainer - INFO - Epoch 2 - Validation Loss: 0.0309, Metrics: {'BinaryPrecision': tensor(0.3962, device='cuda:0'), 'BinaryRecall': tensor(0.3967, device='cuda:0'), 'BinaryF1Score': tensor(0.3965, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(25182, device='cuda:0')}
2025-12-06 02:34:42,300 - trainer - INFO - Epoch 3 - Train Loss: 0.0127, Metrics: {'BinaryPrecision': tensor(0.3973, device='cuda:0'), 'BinaryRecall': tensor(0.4102, device='cuda:0'), 'BinaryF1Score': tensor(0.4037, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(18371, device='cuda:0')}
2025-12-06 02:35:12,730 - trainer - INFO - Epoch 3 - Validation Loss: 0.0291, Metrics: {'BinaryPrecision': tensor(0.3381, device='cuda:0'), 'BinaryRecall': tensor(0.5846, device='cuda:0'), 'BinaryF1Score': tensor(0.4285, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(43475, device='cuda:0')}
2025-12-06 02:35:12,750 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_015902_d58156f5.pt
2025-12-06 02:36:32,973 - trainer - INFO - Epoch 4 - Train Loss: 0.0133, Metrics: {'BinaryPrecision': tensor(0.4130, device='cuda:0'), 'BinaryRecall': tensor(0.4483, device='cuda:0'), 'BinaryF1Score': tensor(0.4299, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(19413, device='cuda:0')}
2025-12-06 02:37:03,136 - trainer - INFO - Epoch 4 - Validation Loss: 0.0296, Metrics: {'BinaryPrecision': tensor(0.4020, device='cuda:0'), 'BinaryRecall': tensor(0.3739, device='cuda:0'), 'BinaryF1Score': tensor(0.3874, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(23387, device='cuda:0')}
2025-12-06 02:38:20,346 - trainer - INFO - Epoch 5 - Train Loss: 0.0442, Metrics: {'BinaryPrecision': tensor(0.4102, device='cuda:0'), 'BinaryRecall': tensor(0.4701, device='cuda:0'), 'BinaryF1Score': tensor(0.4381, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(20506, device='cuda:0')}
2025-12-06 02:38:49,611 - trainer - INFO - Epoch 5 - Validation Loss: 0.0284, Metrics: {'BinaryPrecision': tensor(0.3848, device='cuda:0'), 'BinaryRecall': tensor(0.4492, device='cuda:0'), 'BinaryF1Score': tensor(0.4146, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(29355, device='cuda:0')}
2025-12-06 02:38:49,652 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_015902_d58156f5.pt
2025-12-06 02:38:49,653 - trainer - INFO - Training finished.
2025-12-06 02:38:49,653 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 02:39:11,961 - trainer - INFO - Optimal threshold: 0.4700 (F1: 0.4251)
2025-12-06 02:39:11,965 - trainer - INFO - Threshold updated to 0.4700
2025-12-06 02:39:11,966 - trainer - INFO - Starting testing...
2025-12-06 02:39:56,786 - trainer - INFO - Test Loss: 0.0394, Metrics: {'BinaryPrecision': tensor(0.2897, device='cuda:0'), 'BinaryRecall': tensor(0.4552, device='cuda:0'), 'BinaryF1Score': tensor(0.3541, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 02:40:02,755 - trainer - INFO - Test results saved to src/backend/results/20251206_015902_d58156f5.csv
2025-12-06 02:40:02,941 - trainer - INFO - Testing finished.
2025-12-06 02:40:24,874 - __main__ - INFO - Experiment LSTM_Focal_weight3 completed in 2482.13s
2025-12-06 02:40:24,877 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2897, device='cuda:0'), 'BinaryRecall': tensor(0.4552, device='cuda:0'), 'BinaryF1Score': tensor(0.3541, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 02:40:24,954 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 02:40:24,954 - __main__ - INFO - 
============================================================
2025-12-06 02:40:24,955 - __main__ - INFO - Running experiment 14/16: LSTM_Focal_weight5
2025-12-06 02:40:24,955 - __main__ - INFO -   Model: LSTM
2025-12-06 02:40:24,955 - __main__ - INFO -   Loss: Focal
2025-12-06 02:40:24,955 - __main__ - INFO -   Minority Class Weight: 5
2025-12-06 02:40:24,955 - __main__ - INFO - ============================================================
2025-12-06 02:40:24,969 - __main__ - INFO - Starting experiment: LSTM_Focal_weight5
2025-12-06 02:40:24,976 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 02:40:24,978 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 02:40:25,034 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_024024_e64795c5
2025-12-06 02:40:25,034 - trainer - INFO - Initializing datasets...
2025-12-06 02:40:25,040 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 02:40:25,040 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 02:46:28,959 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 02:47:32,143 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 02:48:24,168 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 02:48:27,475 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 03:10:05,984 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 03:10:38,007 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 03:11:10,623 - trainer - INFO - Number of features: 19
2025-12-06 03:11:10,624 - trainer - INFO - Initializing model...
2025-12-06 03:11:10,710 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 03:11:10,711 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=5
2025-12-06 03:11:10,732 - trainer - INFO - Training components initialized.
2025-12-06 03:11:10,732 - trainer - INFO - Starting training...
2025-12-06 03:11:10,733 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 03:12:48,067 - trainer - INFO - Epoch 1 - Train Loss: 0.0590, Metrics: {'BinaryPrecision': tensor(0.2824, device='cuda:0'), 'BinaryRecall': tensor(0.4420, device='cuda:0'), 'BinaryF1Score': tensor(0.3446, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(27839, device='cuda:0')}
2025-12-06 03:13:18,894 - trainer - INFO - Epoch 1 - Validation Loss: 0.0418, Metrics: {'BinaryPrecision': tensor(0.3039, device='cuda:0'), 'BinaryRecall': tensor(0.6681, device='cuda:0'), 'BinaryF1Score': tensor(0.4177, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(55287, device='cuda:0')}
2025-12-06 03:13:18,955 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_024024_e64795c5.pt
2025-12-06 03:14:47,321 - trainer - INFO - Epoch 2 - Train Loss: 0.0230, Metrics: {'BinaryPrecision': tensor(0.3081, device='cuda:0'), 'BinaryRecall': tensor(0.5641, device='cuda:0'), 'BinaryF1Score': tensor(0.3985, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(32682, device='cuda:0')}
2025-12-06 03:15:18,130 - trainer - INFO - Epoch 2 - Validation Loss: 0.0416, Metrics: {'BinaryPrecision': tensor(0.3124, device='cuda:0'), 'BinaryRecall': tensor(0.6487, device='cuda:0'), 'BinaryF1Score': tensor(0.4217, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(52221, device='cuda:0')}
2025-12-06 03:15:18,155 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_024024_e64795c5.pt
2025-12-06 03:16:38,336 - trainer - INFO - Epoch 3 - Train Loss: 0.0167, Metrics: {'BinaryPrecision': tensor(0.3129, device='cuda:0'), 'BinaryRecall': tensor(0.6066, device='cuda:0'), 'BinaryF1Score': tensor(0.4128, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(34493, device='cuda:0')}
2025-12-06 03:17:08,219 - trainer - INFO - Epoch 3 - Validation Loss: 0.0393, Metrics: {'BinaryPrecision': tensor(0.2824, device='cuda:0'), 'BinaryRecall': tensor(0.7449, device='cuda:0'), 'BinaryF1Score': tensor(0.4096, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(66326, device='cuda:0')}
2025-12-06 03:17:08,304 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_024024_e64795c5.pt
2025-12-06 03:18:29,447 - trainer - INFO - Epoch 4 - Train Loss: 0.0205, Metrics: {'BinaryPrecision': tensor(0.3232, device='cuda:0'), 'BinaryRecall': tensor(0.6380, device='cuda:0'), 'BinaryF1Score': tensor(0.4290, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(35296, device='cuda:0')}
2025-12-06 03:18:59,965 - trainer - INFO - Epoch 4 - Validation Loss: 0.0392, Metrics: {'BinaryPrecision': tensor(0.3456, device='cuda:0'), 'BinaryRecall': tensor(0.5819, device='cuda:0'), 'BinaryF1Score': tensor(0.4337, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(42339, device='cuda:0')}
2025-12-06 03:18:59,988 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_024024_e64795c5.pt
2025-12-06 03:20:19,011 - trainer - INFO - Epoch 5 - Train Loss: 0.0643, Metrics: {'BinaryPrecision': tensor(0.3250, device='cuda:0'), 'BinaryRecall': tensor(0.6620, device='cuda:0'), 'BinaryF1Score': tensor(0.4360, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(36445, device='cuda:0')}
2025-12-06 03:20:48,712 - trainer - INFO - Epoch 5 - Validation Loss: 0.0387, Metrics: {'BinaryPrecision': tensor(0.3299, device='cuda:0'), 'BinaryRecall': tensor(0.6423, device='cuda:0'), 'BinaryF1Score': tensor(0.4359, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(48959, device='cuda:0')}
2025-12-06 03:20:48,737 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_024024_e64795c5.pt
2025-12-06 03:20:48,737 - trainer - INFO - Training finished.
2025-12-06 03:20:48,737 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 03:21:10,627 - trainer - INFO - Optimal threshold: 0.5200 (F1: 0.4330)
2025-12-06 03:21:10,641 - trainer - INFO - Threshold updated to 0.5200
2025-12-06 03:21:10,642 - trainer - INFO - Starting testing...
2025-12-06 03:21:55,522 - trainer - INFO - Test Loss: 0.0531, Metrics: {'BinaryPrecision': tensor(0.3057, device='cuda:0'), 'BinaryRecall': tensor(0.4547, device='cuda:0'), 'BinaryF1Score': tensor(0.3656, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 03:22:01,282 - trainer - INFO - Test results saved to src/backend/results/20251206_024024_e64795c5.csv
2025-12-06 03:22:01,306 - trainer - INFO - Testing finished.
2025-12-06 03:22:24,125 - __main__ - INFO - Experiment LSTM_Focal_weight5 completed in 2519.16s
2025-12-06 03:22:24,129 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.3057, device='cuda:0'), 'BinaryRecall': tensor(0.4547, device='cuda:0'), 'BinaryF1Score': tensor(0.3656, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 03:22:24,213 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 03:22:24,215 - __main__ - INFO - 
============================================================
2025-12-06 03:22:24,215 - __main__ - INFO - Running experiment 15/16: LSTM_Focal_weight10
2025-12-06 03:22:24,216 - __main__ - INFO -   Model: LSTM
2025-12-06 03:22:24,216 - __main__ - INFO -   Loss: Focal
2025-12-06 03:22:24,216 - __main__ - INFO -   Minority Class Weight: 10
2025-12-06 03:22:24,216 - __main__ - INFO - ============================================================
2025-12-06 03:22:24,234 - __main__ - INFO - Starting experiment: LSTM_Focal_weight10
2025-12-06 03:22:24,243 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 03:22:24,244 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 03:22:24,263 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_032224_fbc734ce
2025-12-06 03:22:24,264 - trainer - INFO - Initializing datasets...
2025-12-06 03:22:24,272 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 03:22:24,272 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 03:28:26,216 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 03:29:31,019 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 03:30:24,387 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 03:30:27,743 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 03:49:21,434 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 03:49:48,234 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 03:50:22,738 - trainer - INFO - Number of features: 19
2025-12-06 03:50:22,738 - trainer - INFO - Initializing model...
2025-12-06 03:50:22,823 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 03:50:22,823 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=10
2025-12-06 03:50:22,841 - trainer - INFO - Training components initialized.
2025-12-06 03:50:22,842 - trainer - INFO - Starting training...
2025-12-06 03:50:22,842 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 03:52:02,186 - trainer - INFO - Epoch 1 - Train Loss: 0.0775, Metrics: {'BinaryPrecision': tensor(0.2054, device='cuda:0'), 'BinaryRecall': tensor(0.6724, device='cuda:0'), 'BinaryF1Score': tensor(0.3147, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(58234, device='cuda:0')}
2025-12-06 03:52:32,442 - trainer - INFO - Epoch 1 - Validation Loss: 0.0615, Metrics: {'BinaryPrecision': tensor(0.2290, device='cuda:0'), 'BinaryRecall': tensor(0.8236, device='cuda:0'), 'BinaryF1Score': tensor(0.3584, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(90445, device='cuda:0')}
2025-12-06 03:52:32,492 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_032224_fbc734ce.pt
2025-12-06 03:54:00,917 - trainer - INFO - Epoch 2 - Train Loss: 0.0321, Metrics: {'BinaryPrecision': tensor(0.2242, device='cuda:0'), 'BinaryRecall': tensor(0.7858, device='cuda:0'), 'BinaryF1Score': tensor(0.3488, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(62577, device='cuda:0')}
2025-12-06 03:54:31,661 - trainer - INFO - Epoch 2 - Validation Loss: 0.0611, Metrics: {'BinaryPrecision': tensor(0.2407, device='cuda:0'), 'BinaryRecall': tensor(0.8423, device='cuda:0'), 'BinaryF1Score': tensor(0.3744, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(88008, device='cuda:0')}
2025-12-06 03:54:31,688 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_032224_fbc734ce.pt
2025-12-06 03:55:57,847 - trainer - INFO - Epoch 3 - Train Loss: 0.0256, Metrics: {'BinaryPrecision': tensor(0.2309, device='cuda:0'), 'BinaryRecall': tensor(0.8200, device='cuda:0'), 'BinaryF1Score': tensor(0.3603, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(63197, device='cuda:0')}
2025-12-06 03:56:27,355 - trainer - INFO - Epoch 3 - Validation Loss: 0.0578, Metrics: {'BinaryPrecision': tensor(0.2299, device='cuda:0'), 'BinaryRecall': tensor(0.8758, device='cuda:0'), 'BinaryF1Score': tensor(0.3642, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(95803, device='cuda:0')}
2025-12-06 03:56:27,381 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_032224_fbc734ce.pt
2025-12-06 03:57:49,038 - trainer - INFO - Epoch 4 - Train Loss: 0.0304, Metrics: {'BinaryPrecision': tensor(0.2404, device='cuda:0'), 'BinaryRecall': tensor(0.8315, device='cuda:0'), 'BinaryF1Score': tensor(0.3729, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(61856, device='cuda:0')}
2025-12-06 03:58:18,352 - trainer - INFO - Epoch 4 - Validation Loss: 0.0587, Metrics: {'BinaryPrecision': tensor(0.2400, device='cuda:0'), 'BinaryRecall': tensor(0.8356, device='cuda:0'), 'BinaryF1Score': tensor(0.3729, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(87557, device='cuda:0')}
2025-12-06 03:59:41,787 - trainer - INFO - Epoch 5 - Train Loss: 0.1001, Metrics: {'BinaryPrecision': tensor(0.2461, device='cuda:0'), 'BinaryRecall': tensor(0.8447, device='cuda:0'), 'BinaryF1Score': tensor(0.3812, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(61413, device='cuda:0')}
2025-12-06 04:00:12,906 - trainer - INFO - Epoch 5 - Validation Loss: 0.0561, Metrics: {'BinaryPrecision': tensor(0.2523, device='cuda:0'), 'BinaryRecall': tensor(0.8413, device='cuda:0'), 'BinaryF1Score': tensor(0.3882, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(83842, device='cuda:0')}
2025-12-06 04:00:12,989 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_032224_fbc734ce.pt
2025-12-06 04:00:12,990 - trainer - INFO - Training finished.
2025-12-06 04:00:12,990 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 04:00:34,102 - trainer - INFO - Optimal threshold: 0.5800 (F1: 0.4292)
2025-12-06 04:00:34,113 - trainer - INFO - Threshold updated to 0.5800
2025-12-06 04:00:34,114 - trainer - INFO - Starting testing...
2025-12-06 04:01:18,623 - trainer - INFO - Test Loss: 0.0847, Metrics: {'BinaryPrecision': tensor(0.2852, device='cuda:0'), 'BinaryRecall': tensor(0.4907, device='cuda:0'), 'BinaryF1Score': tensor(0.3607, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 04:01:24,748 - trainer - INFO - Test results saved to src/backend/results/20251206_032224_fbc734ce.csv
2025-12-06 04:01:24,991 - trainer - INFO - Testing finished.
2025-12-06 04:01:47,659 - __main__ - INFO - Experiment LSTM_Focal_weight10 completed in 2363.42s
2025-12-06 04:01:47,663 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2852, device='cuda:0'), 'BinaryRecall': tensor(0.4907, device='cuda:0'), 'BinaryF1Score': tensor(0.3607, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 04:01:47,765 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 04:01:47,765 - __main__ - INFO - 
============================================================
2025-12-06 04:01:47,765 - __main__ - INFO - Running experiment 16/16: LSTM_Focal_weight16
2025-12-06 04:01:47,765 - __main__ - INFO -   Model: LSTM
2025-12-06 04:01:47,766 - __main__ - INFO -   Loss: Focal
2025-12-06 04:01:47,766 - __main__ - INFO -   Minority Class Weight: 16
2025-12-06 04:01:47,766 - __main__ - INFO - ============================================================
2025-12-06 04:01:47,785 - __main__ - INFO - Starting experiment: LSTM_Focal_weight16
2025-12-06 04:01:47,793 - trainer - INFO - Random seed set to 42 for reproducibility
2025-12-06 04:01:47,795 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-12-06 04:01:47,856 - trainer - INFO - TensorBoard logs will be saved to src/backend/logs/20251206_040147_4d3472b3
2025-12-06 04:01:47,857 - trainer - INFO - Initializing datasets...
2025-12-06 04:01:47,864 - dataset - INFO - Found cached preprocessed data, loading from cache...
2025-12-06 04:01:47,864 - dataset - INFO - Loading preprocessed data from cache (key: 6d1bcb3d4045)
2025-12-06 04:07:58,383 - dataset - INFO - Loaded train split (7849246 rows) from cache
2025-12-06 04:09:05,296 - dataset - INFO - Loaded val split (788350 rows) from cache
2025-12-06 04:10:04,757 - dataset - INFO - Loaded test split (847129 rows) from cache
2025-12-06 04:10:08,240 - dataset - INFO - Creating sequences for 35620 groups in split 'train'
2025-12-06 04:31:12,725 - dataset - INFO - Creating sequences for 16222 groups in split 'val'
2025-12-06 04:31:42,020 - dataset - INFO - Creating sequences for 16241 groups in split 'test'
2025-12-06 04:32:22,984 - trainer - INFO - Number of features: 19
2025-12-06 04:32:22,984 - trainer - INFO - Initializing model...
2025-12-06 04:32:23,081 - trainer - INFO - Model LSTM initialized and moved to device: cuda.
2025-12-06 04:32:23,082 - trainer - INFO - Using Focal Loss with gamma=2.0, alpha=16
2025-12-06 04:32:23,101 - trainer - INFO - Training components initialized.
2025-12-06 04:32:23,101 - trainer - INFO - Starting training...
2025-12-06 04:32:23,101 - trainer - INFO - Threshold used for metrics during training: 0.5
2025-12-06 04:33:54,066 - trainer - INFO - Epoch 1 - Train Loss: 0.0908, Metrics: {'BinaryPrecision': tensor(0.1628, device='cuda:0'), 'BinaryRecall': tensor(0.7889, device='cuda:0'), 'BinaryF1Score': tensor(0.2699, device='cuda:0'), 'TrueWildfiresMetric': tensor(17786, device='cuda:0'), 'PredictedWildfiresMetric': tensor(86201, device='cuda:0')}
2025-12-06 04:34:24,991 - trainer - INFO - Epoch 1 - Validation Loss: 0.0796, Metrics: {'BinaryPrecision': tensor(0.2038, device='cuda:0'), 'BinaryRecall': tensor(0.9026, device='cuda:0'), 'BinaryF1Score': tensor(0.3325, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(111378, device='cuda:0')}
2025-12-06 04:34:25,047 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_040147_4d3472b3.pt
2025-12-06 04:35:53,607 - trainer - INFO - Epoch 2 - Train Loss: 0.0399, Metrics: {'BinaryPrecision': tensor(0.1850, device='cuda:0'), 'BinaryRecall': tensor(0.8779, device='cuda:0'), 'BinaryF1Score': tensor(0.3056, device='cuda:0'), 'TrueWildfiresMetric': tensor(17851, device='cuda:0'), 'PredictedWildfiresMetric': tensor(84707, device='cuda:0')}
2025-12-06 04:36:25,989 - trainer - INFO - Epoch 2 - Validation Loss: 0.0800, Metrics: {'BinaryPrecision': tensor(0.1962, device='cuda:0'), 'BinaryRecall': tensor(0.9141, device='cuda:0'), 'BinaryF1Score': tensor(0.3231, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(117166, device='cuda:0')}
2025-12-06 04:37:49,225 - trainer - INFO - Epoch 3 - Train Loss: 0.0330, Metrics: {'BinaryPrecision': tensor(0.1956, device='cuda:0'), 'BinaryRecall': tensor(0.8942, device='cuda:0'), 'BinaryF1Score': tensor(0.3210, device='cuda:0'), 'TrueWildfiresMetric': tensor(17793, device='cuda:0'), 'PredictedWildfiresMetric': tensor(81338, device='cuda:0')}
2025-12-06 04:38:18,709 - trainer - INFO - Epoch 3 - Validation Loss: 0.0744, Metrics: {'BinaryPrecision': tensor(0.1945, device='cuda:0'), 'BinaryRecall': tensor(0.9418, device='cuda:0'), 'BinaryF1Score': tensor(0.3224, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(121759, device='cuda:0')}
2025-12-06 04:38:18,731 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_040147_4d3472b3.pt
2025-12-06 04:39:36,394 - trainer - INFO - Epoch 4 - Train Loss: 0.0384, Metrics: {'BinaryPrecision': tensor(0.2050, device='cuda:0'), 'BinaryRecall': tensor(0.9018, device='cuda:0'), 'BinaryF1Score': tensor(0.3341, device='cuda:0'), 'TrueWildfiresMetric': tensor(17882, device='cuda:0'), 'PredictedWildfiresMetric': tensor(78664, device='cuda:0')}
2025-12-06 04:40:06,010 - trainer - INFO - Epoch 4 - Validation Loss: 0.0748, Metrics: {'BinaryPrecision': tensor(0.2048, device='cuda:0'), 'BinaryRecall': tensor(0.9038, device='cuda:0'), 'BinaryF1Score': tensor(0.3340, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(110959, device='cuda:0')}
2025-12-06 04:41:22,079 - trainer - INFO - Epoch 5 - Train Loss: 0.1207, Metrics: {'BinaryPrecision': tensor(0.2102, device='cuda:0'), 'BinaryRecall': tensor(0.9046, device='cuda:0'), 'BinaryF1Score': tensor(0.3411, device='cuda:0'), 'TrueWildfiresMetric': tensor(17895, device='cuda:0'), 'PredictedWildfiresMetric': tensor(77013, device='cuda:0')}
2025-12-06 04:41:51,821 - trainer - INFO - Epoch 5 - Validation Loss: 0.0724, Metrics: {'BinaryPrecision': tensor(0.2223, device='cuda:0'), 'BinaryRecall': tensor(0.9028, device='cuda:0'), 'BinaryF1Score': tensor(0.3567, device='cuda:0'), 'TrueWildfiresMetric': tensor(25147, device='cuda:0'), 'PredictedWildfiresMetric': tensor(102140, device='cuda:0')}
2025-12-06 04:41:51,848 - trainer - INFO - Saved new best model to src/backend/checkpoints/20251206_040147_4d3472b3.pt
2025-12-06 04:41:51,849 - trainer - INFO - Training finished.
2025-12-06 04:41:51,849 - trainer - INFO - Tuning threshold based on F1 score...
2025-12-06 04:42:14,012 - trainer - INFO - Optimal threshold: 0.6100 (F1: 0.4242)
2025-12-06 04:42:14,023 - trainer - INFO - Threshold updated to 0.6100
2025-12-06 04:42:14,023 - trainer - INFO - Starting testing...
2025-12-06 04:42:59,037 - trainer - INFO - Test Loss: 0.1045, Metrics: {'BinaryPrecision': tensor(0.2700, device='cuda:0'), 'BinaryRecall': tensor(0.5175, device='cuda:0'), 'BinaryF1Score': tensor(0.3549, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 04:43:04,731 - trainer - INFO - Test results saved to src/backend/results/20251206_040147_4d3472b3.csv
2025-12-06 04:43:04,937 - trainer - INFO - Testing finished.
2025-12-06 04:43:27,700 - __main__ - INFO - Experiment LSTM_Focal_weight16 completed in 2499.91s
2025-12-06 04:43:27,703 - __main__ - INFO - Test metrics: {'BinaryPrecision': tensor(0.2700, device='cuda:0'), 'BinaryRecall': tensor(0.5175, device='cuda:0'), 'BinaryF1Score': tensor(0.3549, device='cuda:0'), 'TrueWildfiresMetric': tensor(31564, device='cuda:0'), 'PredictedWildfiresMetric': tensor(31564, device='cuda:0')}
2025-12-06 04:43:27,820 - __main__ - INFO - Intermediate results saved to src/backend/results/grid_search_results.csv
2025-12-06 04:43:27,820 - __main__ - INFO - 
============================================================
2025-12-06 04:43:27,820 - __main__ - INFO - GRID SEARCH COMPLETED
2025-12-06 04:43:27,820 - __main__ - INFO - Total time: 31481.43s (524.69 minutes)
2025-12-06 04:43:27,821 - __main__ - INFO - Results saved to: src/backend/results/grid_search_results.csv
2025-12-06 04:43:27,821 - __main__ - INFO - ============================================================
2025-12-06 04:43:27,821 - __main__ - INFO - 
Results Summary:
2025-12-06 04:43:27,911 - __main__ - INFO -                experiment_name   status  elapsed_time  threshold                  BinaryPrecision                     BinaryRecall                    BinaryF1Score             TrueWildfiresMetric        PredictedWildfiresMetric        model loss_function  minority_class_weight
0      Transformer_BCE_weight3  success    925.875280       0.47  tensor(0.3178, device='cuda:0')  tensor(0.4156, device='cuda:0')  tensor(0.3602, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer           BCE                      3
1      Transformer_BCE_weight5  success   1240.465604       0.60  tensor(0.2976, device='cuda:0')  tensor(0.4142, device='cuda:0')  tensor(0.3464, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer           BCE                      5
2     Transformer_BCE_weight10  success   1527.883302       0.82  tensor(0.3019, device='cuda:0')  tensor(0.3772, device='cuda:0')  tensor(0.3354, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer           BCE                     10
3     Transformer_BCE_weight16  success   1633.010752       0.79  tensor(0.2886, device='cuda:0')  tensor(0.4258, device='cuda:0')  tensor(0.3440, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer           BCE                     16
4    Transformer_Focal_weight3  success   1854.180851       0.48  tensor(0.2934, device='cuda:0')  tensor(0.4618, device='cuda:0')  tensor(0.3588, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer         Focal                      3
5    Transformer_Focal_weight5  success   1889.413941       0.54  tensor(0.3110, device='cuda:0')  tensor(0.3913, device='cuda:0')  tensor(0.3466, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer         Focal                      5
6   Transformer_Focal_weight10  success   1966.630228       0.61  tensor(0.3109, device='cuda:0')  tensor(0.3925, device='cuda:0')  tensor(0.3470, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer         Focal                     10
7   Transformer_Focal_weight16  success   2090.731245       0.67  tensor(0.3144, device='cuda:0')  tensor(0.3914, device='cuda:0')  tensor(0.3487, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')  Transformer         Focal                     16
8             LSTM_BCE_weight3  success   1947.270323       0.47  tensor(0.3039, device='cuda:0')  tensor(0.3456, device='cuda:0')  tensor(0.3234, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM           BCE                      3
9             LSTM_BCE_weight5  success   2008.144146       0.56  tensor(0.2814, device='cuda:0')  tensor(0.4933, device='cuda:0')  tensor(0.3583, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM           BCE                      5
10           LSTM_BCE_weight10  success   2202.519540       0.71  tensor(0.3035, device='cuda:0')  tensor(0.4767, device='cuda:0')  tensor(0.3708, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM           BCE                     10
11           LSTM_BCE_weight16  success   2329.233205       0.78  tensor(0.2812, device='cuda:0')  tensor(0.5184, device='cuda:0')  tensor(0.3646, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM           BCE                     16
12          LSTM_Focal_weight3  success   2482.127948       0.47  tensor(0.2897, device='cuda:0')  tensor(0.4552, device='cuda:0')  tensor(0.3541, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM         Focal                      3
13          LSTM_Focal_weight5  success   2519.155643       0.52  tensor(0.3057, device='cuda:0')  tensor(0.4547, device='cuda:0')  tensor(0.3656, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM         Focal                      5
14         LSTM_Focal_weight10  success   2363.424305       0.58  tensor(0.2852, device='cuda:0')  tensor(0.4907, device='cuda:0')  tensor(0.3607, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM         Focal                     10
15         LSTM_Focal_weight16  success   2499.914823       0.61  tensor(0.2700, device='cuda:0')  tensor(0.5175, device='cuda:0')  tensor(0.3549, device='cuda:0')  tensor(31564, device='cuda:0')  tensor(31564, device='cuda:0')         LSTM         Focal                     16
2025-12-06 04:43:27,933 - __main__ - INFO - Cleaned up temporary config directory: src/backend/temp_configs
