2025-11-26 16:38:42,362 - __main__ - INFO - Loaded configuration from src/backend/config.yaml
2025-11-26 16:38:42,363 - __main__ - DEBUG - Configuration: {'data': {'path': 'data/Wildfire_Dataset.csv', 'features': ['pr', 'rmax', 'rmin', 'sph', 'srad', 'tmmn', 'tmmx', 'vs', 'bi', 'fm100', 'fm1000', 'erc', 'etr', 'pet', 'vpd'], 'split_ratios': {'train': 0.8, 'val': 0.1, 'test': 0.1}, 'window_size': 30}, 'model': {'name': 'Transformer', 'params': {'d_model': 32, 'nhead': 4, 'num_layers': 2, 'dim_feedforward': 512, 'dropout': 0.1}, 'threshold': 0.01}, 'training': {'batch_size': 32, 'epochs': 1, 'max_steps_per_epoch': 1000, 'learning_rate': 0.001, 'loss_function': 'BCE', 'optimizer': 'Adam', 'tune_threshold': True, 'metrics': ['Precision', 'Recall', 'F1Score', 'TrueWildfires', 'PredictedWildfires']}, 'system': {'log_dir': 'src/backend/logs/', 'checkpoint_path': 'src/backend/checkpoints/best_model.pt', 'verbose': True}}
2025-11-26 16:38:44,091 - trainer - INFO - Using CUDA device: NVIDIA GeForce RTX 4060 Laptop GPU
2025-11-26 16:38:44,092 - trainer - INFO - Initializing datasets...
2025-11-26 16:38:44,092 - dataset - INFO - No cached data found, running preprocessing pipeline...
2025-11-26 16:38:44,092 - dataset - INFO - Loading data from data/Wildfire_Dataset.csv
2025-11-26 16:39:02,294 - dataset - DEBUG - Loaded dataframe with shape (9509925, 19)
2025-11-26 16:39:02,294 - dataset - INFO - Preprocessing data for all splits
2025-11-26 16:39:15,970 - dataset - INFO - Dropping 343 groups with all constant features
2025-11-26 16:39:35,435 - dataset - INFO - 
============================================================
Constant Column Summary (columns with std=0 set to zero)
============================================================
Feature                             Count      Percentage
------------------------------------------------------------
pr                                    903           2.46%
============================================================

2025-11-26 16:42:47,051 - dataset - INFO - Saved train split (7587360 rows) to data\preprocessed_cache\train_323d96211f9c.csv
2025-11-26 16:43:13,086 - dataset - INFO - Saved val split (936838 rows) to data\preprocessed_cache\val_323d96211f9c.csv
2025-11-26 16:43:38,671 - dataset - INFO - Saved test split (960002 rows) to data\preprocessed_cache\test_323d96211f9c.csv
2025-11-26 16:43:38,678 - dataset - INFO - Preprocessed data cached with key: 323d96211f9c
2025-11-26 16:43:41,525 - dataset - INFO - Creating sequences for 36755 groups in split 'train'
2025-11-26 16:45:20,140 - dataset - DEBUG - Created 6484710 sequences for split train
2025-11-26 16:45:25,893 - dataset - INFO - Creating sequences for 36755 groups in split 'val'
2025-11-26 16:45:39,059 - dataset - DEBUG - Created 268940 sequences for split val
2025-11-26 16:45:40,377 - dataset - INFO - Creating sequences for 36755 groups in split 'test'
2025-11-26 16:45:54,737 - dataset - DEBUG - Created 274795 sequences for split test
2025-11-26 16:45:54,803 - trainer - DEBUG - Train dataset initialized with 6484710 samples.
2025-11-26 16:45:54,803 - trainer - DEBUG - Val dataset initialized with 268940 samples.
2025-11-26 16:45:54,803 - trainer - DEBUG - Test dataset initialized with 274795 samples.
2025-11-26 16:45:54,811 - trainer - INFO - Number of features: 18
2025-11-26 16:45:54,811 - trainer - INFO - Initializing model...
2025-11-26 16:45:54,811 - trainer - DEBUG - Model parameters: {'d_model': 32, 'nhead': 4, 'num_layers': 2, 'dim_feedforward': 512, 'dropout': 0.1}
2025-11-26 16:45:56,722 - trainer - INFO - Model Transformer initialized and moved to device: cuda.
2025-11-26 16:45:59,891 - trainer - INFO - Training components initialized.
2025-11-26 16:45:59,891 - trainer - INFO - Starting training...
2025-11-26 16:45:59,891 - trainer - INFO - Threshold used for metrics during training: 0.01
2025-11-26 16:46:19,419 - trainer - INFO - Epoch 1 - Train Loss: 0.0003, Metrics: {'BinaryPrecision': tensor(0.0174, device='cuda:0'), 'BinaryRecall': tensor(0.9014, device='cuda:0'), 'BinaryF1Score': tensor(0.0341, device='cuda:0'), 'TrueWildfiresMetric': tensor(71, device='cuda:0'), 'PredictedWildfiresMetric': tensor(3681, device='cuda:0')}
2025-11-26 16:46:24,188 - trainer - INFO - Epoch 1 - Validation Loss: 0.0003, Metrics: {'BinaryPrecision': tensor(0.3176, device='cuda:0'), 'BinaryRecall': tensor(0.9310, device='cuda:0'), 'BinaryF1Score': tensor(0.4737, device='cuda:0'), 'TrueWildfiresMetric': tensor(58, device='cuda:0'), 'PredictedWildfiresMetric': tensor(170, device='cuda:0')}
2025-11-26 16:46:24,214 - trainer - INFO - Saved new best model to src/backend/checkpoints/best_model.pt
2025-11-26 16:46:24,214 - trainer - INFO - Training finished.
2025-11-26 16:46:24,214 - trainer - INFO - Tuning threshold based on F1 score...
2025-11-26 16:46:43,758 - trainer - INFO - Optimal threshold: 0.2300 (F1: 0.8339)
2025-11-26 16:46:43,762 - trainer - INFO - Threshold updated to 0.2300
2025-11-26 16:46:43,762 - trainer - INFO - Starting testing...
2025-11-26 16:47:30,647 - trainer - INFO - Test Loss: 0.1708, Metrics: {'BinaryPrecision': tensor(0.9990, device='cuda:0'), 'BinaryRecall': tensor(0.9364, device='cuda:0'), 'BinaryF1Score': tensor(0.9667, device='cuda:0'), 'TrueWildfiresMetric': tensor(134016, device='cuda:0'), 'PredictedWildfiresMetric': tensor(125616, device='cuda:0')}
2025-11-26 16:47:34,657 - trainer - INFO - Test results saved to src/backend/logs/test_results.csv
2025-11-26 16:47:34,659 - trainer - INFO - Testing finished.
2025-11-26 16:47:34,685 - __main__ - INFO - Total execution time: 532.34 seconds
